/*! jQuery Google Maps Store Locator - v3.3.0 - 2024-04-28
* http://www.bjornblog.com/web/jquery-store-locator-plugin
* Copyright (c) 2024 Bjorn Holine; Licensed MIT */

!function(B,N,j,t){"use strict";var _,a,i,c,Q,V,z,q,U,K,g,h,H,n,m,f,s,W,J,$,o,Z,X,Y,tt,et,st,r,l,it,u,d,nt="storeLocator",b=!1,e=null;function p(t,s){var i,e;_=B(t),this.element=t,this.settings=B.extend({},d,s),this._defaults=d,this._name=nt,this.settings.lazyLoadMap&&null!==this.settings.apiKey&&"undefined"==typeof google?(!!(e={})===(i=this).settings.autoComplete&&(e.libraries="places"),this.settings.callbackBeforeMapInject?new Promise(function(t,e){i.settings.callbackBeforeMapInject.call(this,s,t)}).then(function(){i.triggerMapLoad(e)}):i.triggerMapLoad(e)):this.init()}void 0===B.fn[nt]&&(d={ajaxData:null,altDistanceNoResult:!(u={}),apiKey:null,autoComplete:!(it={}),autoCompleteDisableListener:!(l={}),autoCompleteOptions:{},autoGeocode:!(r={}),bounceMarker:!0,catMarkers:null,dataLocation:"data/locations.json",dataRaw:null,dataType:"json",debug:!(st={}),defaultLat:null,defaultLng:null,defaultLoc:!(et=[]),disableAlphaMarkers:!(tt=[]),distanceAlert:60,dragSearch:!(Y=[]),exclusiveFiltering:!(X=[]),exclusiveTax:null,featuredDistance:null,featuredLocations:!1,fullMapStart:!1,fullMapStartBlank:!1,fullMapStartListLimit:!1,infoBubble:null,inlineDirections:!1,lazyLoadMap:!1,lengthUnit:"m",listColor1:"#ffffff",listColor2:"#eeeeee",loading:!1,locationsPerPage:10,mapSettings:{mapTypeId:"roadmap",zoom:12,mapId:"test"},markerCluster:null,markerImg:null,markerDim:null,maxDistance:!1,modal:!1,nameAttribute:"name",nameSearch:!1,noForm:!1,openNearest:!1,originMarker:!1,originMarkerDim:null,originMarkerImg:null,pagination:!1,querystringParams:!1,selectedMarkerImg:null,selectedMarkerImgDim:null,sessionStorage:!1,slideMap:!0,sortBy:null,storeLimit:26,taxonomyFilters:null,visibleMarkersList:!1,xmlElement:"marker",addressID:"bh-sl-address",closeIcon:"bh-sl-close-icon",formContainer:"bh-sl-form-container",formID:"bh-sl-user-location",geocodeID:null,lengthSwapID:"bh-sl-length-swap",loadingContainer:"bh-sl-loading",locationList:"bh-sl-loc-list",mapID:"bh-sl-map",maxDistanceID:"bh-sl-maxdistance",modalContent:"bh-sl-modal-content",modalWindow:"bh-sl-modal-window",orderID:"bh-sl-order",overlay:"bh-sl-overlay",regionID:"bh-sl-region",searchID:"bh-sl-search",sortID:"bh-sl-sort",taxonomyFiltersContainer:"bh-sl-filters-container",infowindowTemplatePath:"assets/js/plugins/storeLocator/templates/infowindow-description.html",listTemplatePath:"assets/js/plugins/storeLocator/templates/location-list-description.html",KMLinfowindowTemplatePath:"assets/js/plugins/storeLocator/templates/kml-infowindow-description.html",KMLlistTemplatePath:"assets/js/plugins/storeLocator/templates/kml-location-list-description.html",listTemplateID:null,infowindowTemplateID:null,callbackAutoGeoSuccess:null,callbackBeforeMapInject:null,callbackBeforeSend:null,callbackCloseDirections:null,callbackCreateMarker:null,callbackDirectionsRequest:null,callbackFilters:null,callbackFormVals:null,callbackGeocodeRestrictions:null,callbackJsonp:null,callbackListClick:null,callbackMapSet:null,callbackMarkerClick:null,callbackModalClose:null,callbackModalOpen:null,callbackModalReady:null,callbackNearestLoc:null,callbackNoResults:null,callbackNotify:null,callbackOrder:null,callbackPageChange:null,callbackRegion:null,callbackSorting:null,callbackSuccess:null,addressErrorAlert:"Unable to find address",autoGeocodeErrorAlert:"Automatic location detection failed. Please fill in your address or zip code.",distanceErrorAlert:"Unfortunately, our closest location is more than ",kilometerLang:"kilometer",kilometersLang:"kilometers",mileLang:"mile",milesLang:"miles",noResultsTitle:"No results",noResultsDesc:"No locations were found with the given criteria. Please modify your selections or input.",nextPage:"Next &raquo;",prevPage:"&laquo; Prev"},B.extend(p.prototype,{init:function(){var t,e=this;this.writeDebug("init"),"km"===this.settings.lengthUnit?l.EarthRadius=6367:l.EarthRadius=3956,c="kml"===this.settings.dataType?"xml":this.settings.dataType,!0===this.settings.inlineDirections&&B("."+this.settings.locationList).prepend('<div class="bh-sl-directions-panel"></div>'),z=this.settings.mapSettings.zoom,Handlebars.registerHelper("niceURL",function(t){if(t)return t.replace("https://","").replace("http://","")}),!0===this.settings.maxDistance&&this.distanceFiltering(),null!==this.settings.taxonomyFilters&&this.taxonomyFiltering(),this.sorting(),this.order(),!0===this.settings.modal&&(null!==this.settings.taxonomyFilters&&B("."+this.settings.taxonomyFiltersContainer).clone(!0,!0).prependTo(_),_.wrap('<div class="'+this.settings.overlay+'"><div class="'+this.settings.modalWindow+'"><div class="'+this.settings.modalContent+'">'),B("."+this.settings.modalWindow).prepend('<div class="'+this.settings.closeIcon+'"></div>'),B("."+this.settings.overlay).hide()),!0===this.settings.autoComplete&&(t=j.getElementById(this.settings.addressID),t=new google.maps.places.Autocomplete(t,this.settings.autoCompleteOptions),!0===this.settings.autoComplete)&&!0!==this.settings.autoCompleteDisableListener&&t.addListener("place_changed",function(t){e.processForm(t)}),this._loadTemplates()},triggerMapLoad:function(t){this.writeDebug("triggerMapLoad");var e=this;this.loadMapsAPI(this.settings.apiKey,t).then(function(t){e.map=t,e.init()})},injectGoogleMapsScript:function(e){if(this.writeDebug("injectGoogleMapsScript"),e=void 0!==e?e:{},b)throw new Error("Google Maps API is already loaded.");var t="https://maps.googleapis.com/maps/api/js?"+Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t])).join("&"),s=j.createElement("script");s.setAttribute("src",t),s.setAttribute("async",""),s.setAttribute("defer",""),j.head.appendChild(s),b=!0},loadMapsAPI:function(s,i){this.writeDebug("loadMapsAPI"),i=void 0!==i?i:{};var n=this;return e=e||new Promise(function(t,e){try{N.onGoogleMapsAPILoaded=t,n.injectGoogleMapsScript({key:s,callback:"onGoogleMapsAPILoaded",...i})}catch(t){e(t)}}).then(function(){N.google.maps})},destroy:function(){this.writeDebug("destroy"),this.reset();var t=B("#"+this.settings.mapID);if(et.length)for(var e=0;e<=et.length;e++)google.maps.event.removeListener(et[e]);B("."+this.settings.locationList+" ul").empty(),t.hasClass("bh-sl-map-open")&&t.empty().removeClass("bh-sl-map-open"),!0===this.settings.modal&&B(". "+this.settings.overlay).remove(),t.attr("style",""),_.hide(),B.removeData(_.get(0)),B(j).off(nt),_.unbind()},reset:function(){var t;this.writeDebug("reset"),Y=[],X=[],tt=[],W=!(et=[]),B(j).off("click."+nt,"."+this.settings.locationList+" li"),B("."+this.settings.locationList+" .bh-sl-close-directions-container").length&&B(".bh-sl-close-directions-container").remove(),!0===this.settings.inlineDirections&&(0<(t=B("."+this.settings.locationList+" .adp")).length&&(t.remove(),B("."+this.settings.locationList+" ul").fadeIn()),B(j).off("click","."+this.settings.locationList+" li .loc-directions a")),!0===this.settings.pagination&&B(j).off("click."+nt,".bh-sl-pagination li a")},formFiltersReset:function(){var t,e;this.writeDebug("formFiltersReset"),null!==this.settings.taxonomyFilters&&(t=B("."+this.settings.taxonomyFiltersContainer+" input"),e=B("."+this.settings.taxonomyFiltersContainer+" select"),"object"==typeof t)&&(t.each(function(){(B(this).is('input[type="checkbox"]')||B(this).is('input[type="radio"]'))&&B(this).prop("checked",!1)}),e.each(function(){B(this).prop("selectedIndex",0)}))},mapReload:function(){this.writeDebug("mapReload"),this.reset(),J=!0,null!==this.settings.taxonomyFilters&&(this.formFiltersReset(),this.resetDisabledFilterVals(),this.taxonomyFiltersInit()),g&&h?(this.settings.mapSettings.zoom=z,this.processForm()):this.mapping(it)},notify:function(t){this.writeDebug("notify",t),this.settings.callbackNotify?this.settings.callbackNotify.call(this,t):alert(t)},geoCodeCalcToRadian:function(t){return this.writeDebug("geoCodeCalcToRadian",t),t*(Math.PI/180)},geoCodeCalcDiffRadian:function(t,e){return this.writeDebug("geoCodeCalcDiffRadian",arguments),this.geoCodeCalcToRadian(e)-this.geoCodeCalcToRadian(t)},geoCodeCalcCalcDistance:function(t,e,s,i,n){return this.writeDebug("geoCodeCalcCalcDistance",arguments),2*n*Math.asin(Math.min(1,Math.sqrt(Math.pow(Math.sin(this.geoCodeCalcDiffRadian(t,s)/2),2)+Math.cos(this.geoCodeCalcToRadian(t))*Math.cos(this.geoCodeCalcToRadian(s))*Math.pow(Math.sin(this.geoCodeCalcDiffRadian(e,i)/2),2))))},inRange:function(t,e,s){return this.writeDebug("inRange",arguments),e=Math.abs(e),isFinite(e)&&t<=e&&e<=s},coordinatesInRange:function(t,e){return this.writeDebug("coordinatesInRange",arguments),this.inRange(-90,t,90)&&this.inRange(-180,e,180)},getQueryString:function(t){if(this.writeDebug("getQueryString",t),t)return t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null===(t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search))?"":decodeURIComponent(t[1].replace(/\+/g," "))},getMap:function(){return this.map},_loadTemplates:function(){this.writeDebug("_loadTemplates");var e,t=this,s='<div class="bh-sl-error">Error: Could not load plugin templates. Check the paths and ensure they have been uploaded. Paths will be wrong if you do not run this from a web server.</div>';"kml"===this.settings.dataType&&null===this.settings.listTemplateID&&null===this.settings.infowindowTemplateID?B.when(B.get(this.settings.KMLinfowindowTemplatePath,function(t){e=t,i=Handlebars.compile(e)}),B.get(this.settings.KMLlistTemplatePath,function(t){e=t,a=Handlebars.compile(e)})).then(function(){t.locator()},function(){throw B("."+t.settings.formContainer).append(s),new Error("Could not load storeLocator plugin templates")}):null!==this.settings.listTemplateID&&null!==this.settings.infowindowTemplateID?(i=Handlebars.compile(B("#"+this.settings.infowindowTemplateID).html()),a=Handlebars.compile(B("#"+this.settings.listTemplateID).html()),t.locator()):B.when(B.get(this.settings.infowindowTemplatePath,function(t){e=t,i=Handlebars.compile(e)}),B.get(this.settings.listTemplatePath,function(t){e=t,a=Handlebars.compile(e)})).then(function(){t.locator()},function(){throw B("."+t.settings.formContainer).append(s),new Error("Could not load storeLocator plugin templates")})},locator:function(){this.writeDebug("locator"),!0===this.settings.slideMap&&_.hide(),this._start(),this._formEventHandler()},_formEventHandler:function(){this.writeDebug("_formEventHandler");var e=this;!0===this.settings.noForm?(B(j).on("click."+nt,"."+this.settings.formContainer+" button",function(t){e.processForm(t)}),B(j).on("keydown."+nt,function(t){13===t.keyCode&&B("#"+e.settings.addressID).is(":focus")&&e.processForm(t)})):B(j).on("submit."+nt,"#"+this.settings.formID,function(t){e.processForm(t)}),B(".bh-sl-reset").length&&B("#"+this.settings.mapID).length&&B(j).on("click."+nt,".bh-sl-reset",function(){e.mapReload()}),B("#"+this.settings.addressID).on("change."+nt,function(){o=t,u={},""!==B.trim(B("#"+e.settings.addressID).val())||void 0!==U&&""!==U||null!==e.settings.taxonomyFilters&&!1===e.settings.exclusiveFiltering&&(Q=h=g=t,it={},e.resetDisabledFilterVals(),e.taxonomyFiltersInit(),e.mapping(null))})},_getData:function(t,e,s,i,n){this.writeDebug("_getData",arguments);var a,o=this,r="",l="",g="";return void 0!==i&&void 0!==i.geometry.bounds&&(g=i.formatted_address,r=JSON.stringify(i.geometry.bounds.getNorthEast()),l=JSON.stringify(i.geometry.bounds.getSouthWest())),this.settings.callbackBeforeSend&&this.settings.callbackBeforeSend.call(this,t,e,s,g,r,l,n),null!==o.settings.dataRaw?"xml"===c?B.parseXML(o.settings.dataRaw):"json"===c?Array.isArray&&Array.isArray(o.settings.dataRaw)?o.settings.dataRaw:"string"==typeof o.settings.dataRaw?JSON.parse(o.settings.dataRaw):[]:void 0:(a=B.Deferred(),!0===this.settings.loading&&B("."+this.settings.formContainer).append('<div class="'+this.settings.loadingContainer+'"></div>'),i={origLat:t,origLng:e,origAddress:s,formattedAddress:g,boundsNorthEast:r,boundsSouthWest:l},null!==this.settings.ajaxData&&"object"==typeof this.settings.ajaxData&&B.extend(i,this.settings.ajaxData),B.ajax({type:"GET",url:this.settings.dataLocation+("jsonp"===this.settings.dataType?(this.settings.dataLocation.match(/\?/)?"&":"?")+"callback=?":""),data:i,dataType:c,jsonpCallback:"jsonp"===this.settings.dataType?this.settings.callbackJsonp:null}).done(function(t){a.resolve(t),!0===o.settings.loading&&B("."+o.settings.formContainer+" ."+o.settings.loadingContainer).remove()}).fail(a.reject),a.promise())},_start:function(){this.writeDebug("_start");var t,e,s=this,i=this.settings.autoGeocode;!1!==s.settings.fullMapStartBlank?(B("#"+s.settings.mapID).addClass("bh-sl-map-open"),(e=s.settings.mapSettings).zoom=s.settings.fullMapStartBlank,t=new google.maps.LatLng(this.settings.defaultLat,this.settings.defaultLng),e.center=t,s.map=new google.maps.Map(j.getElementById(s.settings.mapID),e),N.addEventListener("resize",function(){var t=s.map.getCenter();google.maps.event.trigger(s.map,"resize"),s.map.setCenter(t)}),s.settings.fullMapStartBlank=!1,e.zoom=z):(!0===this.settings.defaultLoc&&this.defaultLocation(),""!==B.trim(B("#"+this.settings.addressID).val())?(s.writeDebug("Using Address Field"),s.processForm(null),i=!1):!0===this.settings.fullMapStart&&!1===this.settings.defaultLoc&&(!0===this.settings.querystringParams&&this.getQueryString(this.settings.addressID)||!0===this.settings.querystringParams&&this.getQueryString(this.settings.searchID)||!0===this.settings.querystringParams&&this.getQueryString(this.settings.maxDistanceID)?(s.writeDebug("Using Query String"),this.processForm(null),i=!1):this.mapping(null))),!0===this.settings.autoGeocode&&!0===i&&(s.writeDebug("Auto Geo"),s.htmlGeocode()),null!==this.settings.autoGeocode&&(s.writeDebug("Button Geo"),B(j).on("click."+nt,"#"+this.settings.geocodeID,function(){s.htmlGeocode()}))},htmlGeocode:function(){this.writeDebug("htmlGeocode",arguments);var e=this;if(!0===e.settings.sessionStorage&&N.sessionStorage&&N.sessionStorage.getItem("myGeo"))return e.writeDebug("Using Session Saved Values for GEO"),e.autoGeocodeQuery(JSON.parse(N.sessionStorage.getItem("myGeo"))),!1;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){e.writeDebug("Current Position Result");t={coords:{latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy}};!0===e.settings.sessionStorage&&N.sessionStorage&&N.sessionStorage.setItem("myGeo",JSON.stringify(t)),e.settings.callbackAutoGeoSuccess&&e.settings.callbackAutoGeoSuccess.call(this,t),e.autoGeocodeQuery(t)},function(t){e._autoGeocodeError(t)})},googleGeocode:function(t){t.writeDebug("googleGeocode",arguments);var e=new google.maps.Geocoder;this.geocode=function(t,s){e.geocode(t,function(t,e){if(e!==google.maps.GeocoderStatus.OK)throw s(null),new Error("Geocode was not successful for the following reason: "+e);e={};e.latitude=t[0].geometry.location.lat(),e.longitude=t[0].geometry.location.lng(),e.geocodeResult=t[0],s(e)})}},reverseGoogleGeocode:function(t){t.writeDebug("reverseGoogleGeocode",arguments);var e=new google.maps.Geocoder;this.geocode=function(t,s){e.geocode(t,function(t,e){if(e!==google.maps.GeocoderStatus.OK)throw s(null),new Error("Reverse geocode was not successful for the following reason: "+e);t[0]&&((e={}).address=t[0].formatted_address,e.fullResult=t[0],s(e))})}},roundNumber:function(t,e){return this.writeDebug("roundNumber",arguments),Math.round(t*Math.pow(10,e))/Math.pow(10,e)},isEmptyObject:function(t){for(var e in this.writeDebug("isEmptyObject",arguments),t)if(t.hasOwnProperty(e))return!1;return!0},hasEmptyObjectVals:function(t){this.writeDebug("hasEmptyObjectVals",arguments);var e,s=!0;for(e in t)t.hasOwnProperty(e)&&""!==t[e]&&0!==t[e].length&&(s=!1);return s},hasSingleGroupFilterVal:function(t,e){this.writeDebug("hasSingleGroupFilterVal",arguments);t=Object.assign({},t);return!this.hasEmptyObjectVals(t[e])},modalClose:function(){this.writeDebug("modalClose"),this.settings.callbackModalClose&&this.settings.callbackModalClose.call(this),st={},B("."+this.settings.overlay+" select").prop("selectedIndex",0),B("."+this.settings.overlay+" input").prop("checked",!1),B("."+this.settings.overlay).hide()},_createLocationVariables:function(t){var e,s;for(s in this.writeDebug("_createLocationVariables",arguments),r={},Y[t])Y[t].hasOwnProperty(s)&&(e=Y[t][s],"distance"!==s&&"altdistance"!==s||(e=this.roundNumber(e,2)),r[s]=e)},sortAlpha:function(t){this.writeDebug("sortAlpha",arguments);var s=this.settings.sortBy.hasOwnProperty("prop")&&void 0!==this.settings.sortBy.prop?this.settings.sortBy.prop:"name";this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?t.sort(function(t,e){return e[s].toLowerCase().localeCompare(t[s].toLowerCase())}):t.sort(function(t,e){return t[s].toLowerCase().localeCompare(e[s].toLowerCase())})},sortDate:function(t){this.writeDebug("sortDate",arguments);var s=this.settings.sortBy.hasOwnProperty("prop")&&void 0!==this.settings.sortBy.prop?this.settings.sortBy.prop:"date";this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?t.sort(function(t,e){return new Date(e[s]).getTime()-new Date(t[s]).getTime()}):t.sort(function(t,e){return new Date(t[s]).getTime()-new Date(e[s]).getTime()})},sortNumerically:function(t,e){this.writeDebug("sortNumerically",arguments);var s=null!==this.settings.sortBy&&this.settings.sortBy.hasOwnProperty("prop")&&void 0!==this.settings.sortBy.prop?this.settings.sortBy.prop:"distance";void 0!==e&&!0===e&&(s="distance"),null!==this.settings.sortBy&&this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?t.sort(function(t,e){return e[s]<t[s]?-1:e[s]>t[s]?1:0}):t.sort(function(t,e){return t[s]<e[s]?-1:t[s]>e[s]?1:0})},sortCustom:function(t){this.writeDebug("sortCustom",arguments),this.settings.sortBy.hasOwnProperty("method")&&"alpha"===this.settings.sortBy.method.toString()?this.sortAlpha(t):this.settings.sortBy.hasOwnProperty("method")&&"date"===this.settings.sortBy.method.toString()?this.sortDate(t):this.sortNumerically(t)},filterMatching:function(t,e,s){return this.writeDebug("inclusiveFilter",arguments),void 0!==e&&(s=!0===(s=void 0===s||s)?t.join(""):t.join("|"),!!new RegExp(s,"i").test(e.replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,"")))},filterData:function(t,e){this.writeDebug("filterData",arguments);var s,i=!0;for(s in e)if(e.hasOwnProperty(s)){for(var n=[],a=0;a<e[s].length;a++)!0===this.settings.exclusiveFiltering||null!==this.settings.exclusiveTax&&Array.isArray(this.settings.exclusiveTax)&&-1!==this.settings.exclusiveTax.indexOf(s)?n[a]=this.filterMatching(e[s],t[s],!1):n[a]=this.filterMatching(e[s],t[s]);if(void 0!==$&&-1!==$.indexOf(s)&&-1!==n.indexOf(!0))return!0;-1===n.indexOf(!0)&&(i=!1)}return i},_paginationOutput:function(t,e){this.writeDebug("_paginationOutput",arguments),t=parseInt(t),e=Math.ceil(e);var s,i="",n=t+1,a=t-1,o=Math.ceil(2.5),r=Math.floor(2.5),l=e<5?(s=0,e):0<=t&&t<=o?(s=0,5):e<=t+r?(s=e-5,e):(s=t-o,t+r);0<t&&(i=(i+='<li class="bh-sl-next-prev" data-page="'+a+'">')+'<a href="javascript:void(0);" aria-label="Previous page">'+this.settings.prevPage+"</a></li>"),5<=t+1&&5<e&&(i+='<li data-page="0"><a href="javascript:void(0);" aria-label="Page 1">1</a></li><li aria-label="ellipsis indicating non-visible pages"><span>&hellip;</span></li>');for(var g=s;g<l;g++)var c=g+1,i=g===t?(i+='<li class="bh-sl-current" data-page="'+g+'">')+'<a class="bh-sl-current-page" href="javascript:void(0);" aria-label="Page '+c+'" aria-current="page">'+c+"</a></li>":(i+='<li data-page="'+g+'">')+'<a href="javascript:void(0);" aria-label="Page '+c+'">'+c+"</a></li>";return t+o<=e&&5<e&&(i=(i=(i+='<li aria-label="ellipsis indicating non-visible pages"><span>&hellip;</span>')+'</li><li data-page="'+(e-1)+'">')+'<a href="javascript:void(0);" aria-label="Page '+e+'">'+e+"</a></li>"),i=n<e?(i+='<li class="bh-sl-next-prev" data-page="'+n+'">')+'<a href="javascript:void(0);" aria-label="Next page">'+this.settings.nextPage+"</a></li>":i},paginationReset:function(){this.writeDebug("paginationReset",arguments);var t=N.location.href,t=new URL(t);t.searchParams.delete("bhsl-page"),history.pushState&&N.history.pushState({path:t.href},"",t.href)},totalPages:function(){return this.writeDebug("totalPages",arguments),!(void 0!==Q&&0<this.settings.storeLimit&&Y.length>this.settings.storeLimit)&&(-1===this.settings.storeLimit||Y.length<this.settings.storeLimit)?Y.length/this.settings.locationsPerPage:this.settings.storeLimit/this.settings.locationsPerPage},paginationSetup:function(t){this.writeDebug("paginationSetup",arguments);var e="",s=B(".bh-sl-pagination-container .bh-sl-pagination"),i=this.totalPages();void 0===t&&(t=0),e=(0===s.length||s.empty(),this._paginationOutput(t,i)),s.append(e)},markerImage:function(t,e,s){this.writeDebug("markerImage",arguments);var i=j.createElement("img");return i.src=t,void 0!==e&&void 0!==s?(i.height=s,i.width=e):(i.height=32,i.width=32),i},createMarker:function(t,e,s,i,n,a){var o;this.writeDebug("createMarker",arguments);if(null!==this.settings.catMarkers&&void 0!==a)if(-1!==a.indexOf(","))for(var r=a.split(","),l=0;l<r.length;l++)r[l]in this.settings.catMarkers&&(o=this.markerImage(this.settings.catMarkers[r[l]][0],Number(this.settings.catMarkers[r[l]][1]),Number(this.settings.catMarkers[r[l]][2])));else a in this.settings.catMarkers&&(o=this.markerImage(this.settings.catMarkers[a][0],Number(this.settings.catMarkers[a][1]),Number(this.settings.catMarkers[a][2])));return null!==this.settings.markerImg&&(o=null===this.settings.markerDim?this.markerImage(this.settings.markerImg):this.markerImage(this.settings.markerImg,this.settings.markerDim.width,this.settings.markerDim.height)),this.settings.callbackCreateMarker?this.settings.callbackCreateMarker.call(this,n,t,i,a):!0===this.settings.disableAlphaMarkers||-1===this.settings.storeLimit||26<this.settings.storeLimit||null!==this.settings.catMarkers||null!==this.settings.markerImg||!0===this.settings.fullMapStart&&!0===W&&(isNaN(this.settings.fullMapStartListLimit)||26<this.settings.fullMapStartListLimit||-1===this.settings.fullMapStartListLimit)?new google.maps.marker.AdvancedMarkerElement({content:o,draggable:!1,map:n,position:t,title:e}):(a=new google.maps.marker.PinElement({glyph:i}),new google.maps.marker.AdvancedMarkerElement({content:a.element,draggable:!1,map:n,position:t,title:e}))},_defineLocationData:function(t,e,s){this.writeDebug("_defineLocationData",arguments);var i,n,a="",t=(this._createLocationVariables(t.bhslID),i=r.distance<=1?"km"===this.settings.lengthUnit?(n=this.settings.kilometerLang,this.settings.mileLang):(n=this.settings.mileLang,this.settings.kilometerLang):"km"===this.settings.lengthUnit?(n=this.settings.kilometersLang,this.settings.milesLang):(n=this.settings.milesLang,this.settings.kilometersLang),t.bhslID),a=!0===this.settings.disableAlphaMarkers||-1===this.settings.storeLimit||26<this.settings.storeLimit||!0===this.settings.fullMapStart&&!0===W&&(isNaN(this.settings.fullMapStartListLimit)||26<this.settings.fullMapStartListLimit||-1===this.settings.fullMapStartListLimit)?0<s?e+t+1:t+1:0<s?String.fromCharCode("A".charCodeAt(0)+(e+t)):String.fromCharCode("A".charCodeAt(0)+t);return{location:[B.extend(r,{markerid:t,marker:a,altlength:i,length:n,origin:Q})]}},listSetup:function(t,e,s){this.writeDebug("listSetup",arguments);t=this._defineLocationData(t,e,s),e=a(t);B("."+this.settings.locationList+" > ul").append(e)},changeSelectedMarker:function(t){var e;void 0!==s&&s.setIcon(f),e=null===this.settings.selectedMarkerImgDim?this.markerImage(this.settings.selectedMarkerImg):this.markerImage(this.settings.selectedMarkerImg,this.settings.selectedMarkerImgDim.width,this.settings.selectedMarkerImgDim.height),f=t.icon,t.setIcon(e),s=t},createInfowindow:function(n,t,a,e,s){this.writeDebug("createInfowindow",arguments);var o=this,e=this._defineLocationData(n,e,s),r=i(e);"left"===t?(a.setContent(r),a.open(n.map,n)):n.addListener("click",function(t,e){a.setContent(r),a.open(n.map,n);var s=n.bhslID,i=B("."+o.settings.locationList+" li[data-markerid="+s+"]");0<i.length&&(o.settings.callbackMarkerClick&&o.settings.callbackMarkerClick.call(this,n,s,i,Y[s],o.map),B("."+o.settings.locationList+" li").removeClass("list-focus"),i.addClass("list-focus"),(s=B("."+o.settings.locationList)).animate({scrollTop:i.offset().top-s.offset().top+s.scrollTop()})),null!==o.settings.selectedMarkerImg&&o.changeSelectedMarker(n)})},autoGeocodeQuery:function(e){this.writeDebug("autoGeocodeQuery",arguments);var s,i=this,n=null,t=B("#"+this.settings.maxDistanceID),t=(!0===this.settings.querystringParams&&this.getQueryString(this.settings.maxDistanceID)?(n=this.getQueryString(this.settings.maxDistanceID),""!==t.val()&&(n=t.val())):!0===this.settings.maxDistance&&(n=t.val()||""),new this.reverseGoogleGeocode(this)),a=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);t.geocode({latLng:a},function(t){null!==t?(s=K=t.address,g=it.lat=e.coords.latitude,h=it.lng=e.coords.longitude,it.origin=s,it.distance=n,i.mapping(it),void 0!==s&&B("#"+i.settings.addressID).val(s)):i.notify(i.settings.addressErrorAlert)})},_autoGeocodeError:function(){this.writeDebug("_autoGeocodeError"),this.notify(this.settings.autoGeocodeErrorAlert)},defaultLocation:function(){this.writeDebug("defaultLocation");var e,s=this,i=null,t=B("#"+this.settings.maxDistanceID),t=(!0===this.settings.querystringParams&&this.getQueryString(this.settings.maxDistanceID)?(i=this.getQueryString(this.settings.maxDistanceID),""!==t.val()&&(i=t.val())):!0===this.settings.maxDistance&&(i=t.val()||""),new this.reverseGoogleGeocode(this)),n=new google.maps.LatLng(this.settings.defaultLat,this.settings.defaultLng);t.geocode({latLng:n},function(t){null!==t?(e=K=t.address,g=it.lat=s.settings.defaultLat,h=it.lng=s.settings.defaultLng,it.distance=i,it.origin=e,s.mapping(it)):s.notify(s.settings.addressErrorAlert)})},paginationChange:function(t){this.writeDebug("paginationChange",arguments);var e=N.location.href,e=new URL(e);e.searchParams.set("bhsl-page",parseInt(t)+1),history.pushState&&N.history.pushState({path:e.href},"",e.href),this.settings.callbackPageChange&&this.settings.callbackPageChange.call(this,t),it.page=t,this.mapping(it)},getAddressByMarker:function(t){this.writeDebug("getAddressByMarker",arguments);var e="";return Y[t].address&&(e+=Y[t].address+" "),Y[t].address2&&(e+=Y[t].address2+" "),Y[t].city&&(e+=Y[t].city+", "),Y[t].state&&(e+=Y[t].state+" "),Y[t].postal&&(e+=Y[t].postal+" "),Y[t].country&&(e+=Y[t].country+" "),e},clearMarkers:function(){this.writeDebug("clearMarkers");for(var t=null,t=Y.length<this.settings.storeLimit?Y.length:this.settings.storeLimit,e=0;e<t;e++)et[e].setMap(null)},directionsRequest:function(t,e,s){this.writeDebug("directionsRequest",arguments),this.settings.callbackDirectionsRequest&&this.settings.callbackDirectionsRequest.call(this,t,e,s,Y[e]);e=this.getAddressByMarker(e);e&&(B("."+this.settings.locationList+" ul").hide(),this.clearMarkers(),null!=n&&(n.setMap(null),n=null),n=new google.maps.DirectionsRenderer,m=new google.maps.DirectionsService,n.setMap(s),n.setPanel(B(".bh-sl-directions-panel").get(0)),s={origin:t,destination:e,travelMode:google.maps.TravelMode.DRIVING},m.route(s,function(t,e){e===google.maps.DirectionsStatus.OK&&n.setDirections(t)}),B("."+this.settings.locationList).prepend('<div class="bh-sl-close-directions-container"><div class="'+this.settings.closeIcon+'"></div></div>')),B(j).off("click","."+this.settings.locationList+" li .loc-directions a")},closeDirections:function(){this.writeDebug("closeDirections"),this.settings.callbackCloseDirections&&this.settings.callbackCloseDirections.call(this),this.reset(),g&&h&&(0===this.countFilters()?this.settings.mapSettings.zoom=z:this.settings.mapSettings.zoom=0,this.processForm(null)),B(j).off("click."+nt,"."+this.settings.locationList+" .bh-sl-close-icon")},lengthUnitSwap:function(t){this.writeDebug("lengthUnitSwap",arguments),"alt-distance"===t.val()?(B("."+this.settings.locationList+" .loc-alt-dist").show(),B("."+this.settings.locationList+" .loc-default-dist").hide()):"default-distance"===t.val()&&(B("."+this.settings.locationList+" .loc-default-dist").show(),B("."+this.settings.locationList+" .loc-alt-dist").hide())},processForm:function(t){this.writeDebug("processForm",arguments);var e=this,s=null,i={},n=B("#"+this.settings.addressID),a=B("#"+this.settings.searchID),o=B("#"+this.settings.maxDistanceID),r="";null!=t&&t.preventDefault(),B("."+e.settings.formContainer+" input, ."+e.settings.formContainer+" select").blur(),!0===this.settings.querystringParams&&(this.getQueryString(this.settings.addressID)||this.getQueryString(this.settings.searchID)||this.getQueryString(this.settings.maxDistanceID))?(K=this.getQueryString(this.settings.addressID),U=this.getQueryString(this.settings.searchID),(s=this.getQueryString(this.settings.maxDistanceID))&&B("#"+this.settings.maxDistanceID+" option[value="+s+"]").length&&o.val(s),K&&s&&(e.settings.mapSettings.zoom=0),""!==n.val()&&(K=n.val()),""!==a.val()&&(U=a.val()),""!==o.val()&&(s=o.val())):(K=n.val()||"",U=a.val()||"",!0===this.settings.maxDistance&&(s=o.val()||"")),r=this.settings.callbackRegion?this.settings.callbackRegion.call(this,K,U,s):B("#"+this.settings.regionID).val(),this.settings.callbackFormVals&&this.settings.callbackFormVals.call(this,K,U,s,r),void 0!==r&&(i={country:r}),"function"==typeof this.settings.callbackGeocodeRestrictions&&(i=this.settings.callbackGeocodeRestrictions.call(this,K,U,s)),""===K&&""===U&&!0!==this.settings.autoGeocode?this._start():""!==K?(""===U&&st.hasOwnProperty("name")&&delete st.name,void 0!==Q&&void 0!==g&&void 0!==h&&K===Q?(it.lat=g,it.lng=h,it.origin=K,it.name=U,it.distance=s,e.mapping(it)):new this.googleGeocode(this).geocode({address:K,componentRestrictions:i,region:r},function(t){null!==t?(g=t.latitude,h=t.longitude,it.lat=g,it.lng=h,it.origin=K,it.name=U,it.distance=s,it.geocodeResult=t.geocodeResult,e.mapping(it)):e.notify(e.settings.addressErrorAlert)})):""!==U?(""===K&&delete it.origin,it.name=U,e.mapping(it)):!0===this.settings.autoGeocode&&(it.lat=g,it.lng=h,it.origin=K,it.name=U,it.distance=s,e.mapping(it)),void 0!==Q&&K!==Q&&this.paginationReset()},locationsSetup:function(t,e,s,i,n){this.writeDebug("locationsSetup",arguments),void 0===i||t.distance||(t.distance=this.geoCodeCalcCalcDistance(e,s,t.lat,t.lng,l.EarthRadius),"m"===this.settings.lengthUnit?t.altdistance=1.609344*parseFloat(t.distance):"km"===this.settings.lengthUnit&&(t.altdistance=parseFloat(t.distance)/1.609344)),this.coordinatesInRange(t.lat,t.lng)?!0===this.settings.maxDistance&&null!=n?t.distance<=n?Y.push(t):this.writeDebug("locationsSetup","location ignored because it is out of maxDistance: "+n,t):!0!==this.settings.maxDistance||!0!==this.settings.querystringParams||null==n||t.distance<=n?Y.push(t):this.writeDebug("locationsSetup","location ignored because it is out of maxDistance: "+n,t):this.writeDebug("locationsSetup","location ignored because coordinates out of range: "+n,t)},sorting:function(){this.writeDebug("sorting",arguments);var s=this,i=B("#"+s.settings.mapID),t=B("#"+s.settings.sortID);0!==t.length&&t.on("change."+nt,function(t){var e;t.stopPropagation(),!0===s.settings.pagination&&s.paginationChange(0),t=void 0!==B(this).find(":selected").attr("data-method")?B(this).find(":selected").attr("data-method"):"distance",e=B(this).val(),s.settings.sortBy.method=t,s.settings.sortBy.prop=e,s.settings.callbackSorting&&s.settings.callbackSorting.call(this,s.settings.sortBy),i.hasClass("bh-sl-map-open")&&s.mapping(it)})},order:function(){this.writeDebug("order",arguments);var e=this,s=B("#"+e.settings.mapID),t=B("#"+e.settings.orderID);0!==t.length&&t.on("change."+nt,function(t){t.stopPropagation(),!0===e.settings.pagination&&e.paginationChange(0),e.settings.sortBy.order=B(this).val(),e.settings.callbackOrder&&e.settings.callbackOrder.call(this,e.settings.order),s.hasClass("bh-sl-map-open")&&e.mapping(it)})},distanceFiltering:function(){this.writeDebug("distanceFiltering");var e=this;B("#"+this.settings.maxDistanceID).on("change."+nt,function(t){t.stopPropagation(),!0===e.settings.querystringParams&&(t=N.location.href,(t=new URL(t)).searchParams.set(e.settings.maxDistanceID,this.value),history.pushState?N.history.pushState({path:t.href},"",t.href):N.location.replace(t.href)),!0===B("#"+e.settings.mapID).hasClass("bh-sl-map-open")&&(g&&h?(e.settings.mapSettings.zoom=0,e.processForm()):e.mapping(it))})},countFilters:function(){this.writeDebug("countFilters");var t=0;if(!this.isEmptyObject(st))for(var e in st)st.hasOwnProperty(e)&&(t+=st[e].length);return t},_existingCheckedFilters:function(e){this.writeDebug("_existingCheckedFilters",arguments),B("#"+this.settings.taxonomyFilters[e]+" input[type=checkbox]").each(function(){var t;B(this).prop("checked")&&void 0!==(t=B(this).val())&&""!==t&&-1===st[e].indexOf(t)&&st[e].push(t)})},_existingSelectedFilters:function(e){this.writeDebug("_existingSelectedFilters",arguments),B("#"+this.settings.taxonomyFilters[e]+" select").each(function(){var t=B(this).val();void 0!==t&&""!==t&&-1===st[e].indexOf(t)&&(st[e]=[t])})},_existingRadioFilters:function(e){this.writeDebug("_existingRadioFilters",arguments),B("#"+this.settings.taxonomyFilters[e]+" input[type=radio]").each(function(){var t;B(this).prop("checked")&&void 0!==(t=B(this).val())&&""!==t&&-1===st[e].indexOf(t)&&(st[e]=[t])})},checkFilters:function(){for(var t in this.writeDebug("checkFilters"),this.settings.taxonomyFilters)this.settings.taxonomyFilters.hasOwnProperty(t)&&(this._existingCheckedFilters(t),this._existingSelectedFilters(t),this._existingRadioFilters(t))},selectQueryStringFilters:function(t,e){this.writeDebug("selectQueryStringFilters",arguments);var s=B("#"+this.settings.taxonomyFilters[t]);if(s.find('input[type="checkbox"]').length)for(var i=0;i<e.length;i++)s.find('input:checkbox[value="'+e[i]+'"]').prop("checked",!0);s.find("select").length&&s.find('option[value="'+e[0]+'"]').prop("selected",!0),s.find('input[type="radio"]').length&&s.find('input:radio[value="'+e[0]+'"]').prop("checked",!0)},checkQueryStringFilters:function(){for(var t in this.writeDebug("checkQueryStringFilters",arguments),st){var e;st.hasOwnProperty(t)&&(void 0!==(e=-1!==(e=this.getQueryString(t)).indexOf(",")?e.split(","):e)&&""!==e&&-1===st[t].indexOf(e)&&(Array.isArray(e)?st[t]=e:st[t]=[e]),st[t].length)&&this.selectQueryStringFilters(t,st[t])}},getFilterKey:function(t){for(var e in this.writeDebug("getFilterKey",arguments),this.settings.taxonomyFilters)if(this.settings.taxonomyFilters.hasOwnProperty(e))for(var s=0;s<this.settings.taxonomyFilters[e].length;s++)if(this.settings.taxonomyFilters[e]===t)return e},taxonomyFiltersInit:function(){for(var t in this.writeDebug("taxonomyFiltersInit"),this.settings.taxonomyFilters)this.settings.taxonomyFilters.hasOwnProperty(t)&&(st[t]=[])},taxonomyFiltering:function(){this.writeDebug("taxonomyFiltering");var n=this;n.taxonomyFiltersInit(),n.checkQueryStringFilters(),B("."+this.settings.taxonomyFiltersContainer).on("change."+nt,"input, select",function(t){var e,s,i;t.stopPropagation(),!0===n.settings.pagination&&n.paginationReset(),B(this).is('input[type="checkbox"]')?(n.checkFilters(),e=B(this).val(),s=B(this).closest(".bh-sl-filters").attr("id"),(i=n.getFilterKey(s))&&(B(this).prop("checked")?(-1===st[i].indexOf(e)&&st[i].push(e),!0===B("#"+n.settings.mapID).hasClass("bh-sl-map-open")&&(g&&h?(n.settings.mapSettings.zoom=0,n.processForm()):n.mapping(it))):-1<(t=st[i].indexOf(e))&&(st[i].splice(t,1),!0===B("#"+n.settings.mapID).hasClass("bh-sl-map-open"))&&(g&&h?(0===n.countFilters()?n.settings.mapSettings.zoom=z:n.settings.mapSettings.zoom=0,n.processForm()):n.mapping(it)))):(B(this).is("select")||B(this).is('input[type="radio"]'))&&(n.checkFilters(),e=B(this).val(),s=B(this).closest(".bh-sl-filters").attr("id"),i=n.getFilterKey(s),e?i&&(st[i]=[e],!0===B("#"+n.settings.mapID).hasClass("bh-sl-map-open"))&&(g&&h?(n.settings.mapSettings.zoom=0,n.processForm()):n.mapping(it)):(i&&(st[i]=[]),n.reset(),g&&h?(n.settings.mapSettings.zoom=z,n.processForm()):n.mapping(it)))})},checkVisibleMarkers:function(t,s){this.writeDebug("checkVisibleMarkers",arguments);var i,n=this;B("."+this.settings.locationList+" ul").empty(),B(t).each(function(t,e){s.getBounds().contains(e.position)&&(n.listSetup(e,0,0),i=a(void 0),B("."+n.settings.locationList+" > ul").append(i))}),B("."+this.settings.locationList+" ul li:even").css("background",this.settings.listColor1),B("."+this.settings.locationList+" ul li:odd").css("background",this.settings.listColor2)},dragSearch:function(t){this.writeDebug("dragSearch",arguments);var e=t.getCenter(),s=this,t=(this.settings.mapSettings.zoom=t.getZoom(),g=it.lat=e.lat(),h=it.lng=e.lng(),new this.reverseGoogleGeocode(this)),e=new google.maps.LatLng(it.lat,it.lng);t.geocode({latLng:e},function(t){null!==t?(it.origin=K=t.address,s.mapping(it)):s.notify(s.settings.addressErrorAlert)})},emptyResult:function(){this.writeDebug("emptyResult",arguments);var t=B("."+this.settings.locationList+" ul"),e=this.settings.mapSettings;this.map=new google.maps.Map(j.getElementById(this.settings.mapID),e),this.settings.callbackNoResults&&this.settings.callbackNoResults.call(this,this.map,e),t.empty(),e=B('<li><div class="bh-sl-noresults-title">'+this.settings.noResultsTitle+'</div><br><div class="bh-sl-noresults-desc">'+this.settings.noResultsDesc+"</li>").hide().fadeIn(),t.append(e),t=g&&h?new google.maps.LatLng(g,h):new google.maps.LatLng(0,0),this.map.setCenter(t),z&&this.map.setZoom(z)},originMarker:function(t,e,s){this.writeDebug("originMarker",arguments),!0===this.settings.originMarker&&void 0!==e&&(e=new google.maps.marker.PinElement({background:"#39b25e",borderColor:"#177d3d",glyphColor:"#177d3c"}),e=new google.maps.marker.AdvancedMarkerElement({content:e.element,draggable:!1,map:t,position:s,title:name}),null!==this.settings.originMarkerImg)&&(t=j.createElement("img"),null===this.settings.originMarkerDim?t.src=this.settings.originMarkerImg:t=this.markerImage(this.settings.originMarkerImg,this.settings.originMarkerDim.width,this.settings.originMarkerDim.height),e.content=t)},modalWindow:function(){var e;this.writeDebug("modalWindow"),!0===this.settings.modal&&((e=this).settings.callbackModalOpen&&e.settings.callbackModalOpen.call(this),B("."+e.settings.overlay).fadeIn(),B(j).on("click."+nt,"."+e.settings.closeIcon+", ."+e.settings.overlay,function(){e.modalClose()}),B(j).on("click."+nt,"."+e.settings.modalWindow,function(t){t.stopPropagation()}),B(j).on("keyup."+nt,function(t){27===t.keyCode&&e.modalClose()}))},openNearestLocation:function(t,e,s,i){var n,a;this.writeDebug("openNearestLocation",arguments),!0!==this.settings.openNearest||void 0===t||void 0===Q||!0===this.settings.fullMapStart&&!0===W&&!1===this.settings.querystringParams||!0===this.settings.defaultLoc&&!0===W&&!1===this.settings.querystringParams||((n=this).settings.callbackNearestLoc&&n.settings.callbackNearestLoc.call(this,n.map,t,e,s,i),t=t.hasOwnProperty("markerid")?t.markerid:0,a=et[t],n.createInfowindow(a,"left",e,s,i),a=B("."+n.settings.locationList),e=B("."+n.settings.locationList+" li[data-markerid="+t+"]"),B("."+n.settings.locationList+" li").removeClass("list-focus"),e.addClass("list-focus"),a.animate({scrollTop:e.offset().top-a.offset().top+a.scrollTop()}))},listClick:function(s,i,n,a){this.writeDebug("listClick",arguments);var o=this;B(j).on("click."+nt,"."+o.settings.locationList+" li",function(){var t=B(this).data("markerid"),e=et[t];o.settings.callbackListClick&&o.settings.callbackListClick.call(this,t,e,Y[t],s),s.panTo(e.position);o.createInfowindow(e,"left",i,n,a),null!==o.settings.selectedMarkerImg&&o.changeSelectedMarker(e),B("."+o.settings.locationList+" li").removeClass("list-focus"),B("."+o.settings.locationList+" li[data-markerid="+t+"]").addClass("list-focus")}),B(j).on("click."+nt,"."+o.settings.locationList+" li a",function(t){t.stopPropagation()})},resultsTotalCount:function(t){this.writeDebug("resultsTotalCount",arguments);var e=B(".bh-sl-total-results");void 0===t||t<=0||0===e.length||e.text(t)},inlineDirections:function(e,s){var i;this.writeDebug("inlineDirections",arguments),!0===this.settings.inlineDirections&&void 0!==s&&(i=this,B(j).on("click."+nt,"."+i.settings.locationList+" li .loc-directions a",function(t){t.preventDefault();t=B(this).closest("li").attr("data-markerid");i.directionsRequest(s,parseInt(t),e),B(j).on("click."+nt,"."+i.settings.locationList+" .bh-sl-close-icon",function(){i.closeDirections()})}))},visibleMarkersList:function(t,e){var s;this.writeDebug("visibleMarkersList",arguments),!0===this.settings.visibleMarkersList&&(s=this,google.maps.event.addListenerOnce(t,"idle",function(){s.checkVisibleMarkers(e,t)}),google.maps.event.addListener(t,"center_changed",function(){s.checkVisibleMarkers(e,t)}),google.maps.event.addListener(t,"zoom_changed",function(){s.checkVisibleMarkers(e,t)}))},featuredDistanceRestriction:function(){this.writeDebug("featuredDistanceRestriction",arguments);var e=this;return X=B.grep(X,function(t){if(t.hasOwnProperty("distance"))return parseFloat(t.distance)<=parseFloat(e.settings.featuredDistance)})},featuredRestrictions:function(t){return this.writeDebug("featuredRestrictions",arguments),X=null!==this.settings.featuredDistance&&null!==this.settings.featuredDistance?this.featuredDistanceRestriction(t):X},mapping:function(e){this.writeDebug("mapping",arguments);var t,s,i,n,a,o,r=this,l=(this.isEmptyObject(e)||(t=e.lat,s=e.lng,i=e.geocodeResult,n=e.origin,o=e.page),!0===r.settings.pagination&&(Z=o=void 0!==o&&Q===K?o:0),r.getQueryString("bhsl-page"));""!==l&&(o=Z=parseInt(l)-1),q=void 0===n&&!0===this.settings.nameSearch?r._getData():(a=new google.maps.LatLng(t,s),void 0!==Q&&n===Q&&void 0!==V&&!0!==this.settings.pagination?(n=Q,V):r._getData(g,h,n,i,e)),null!==r.settings.taxonomyFilters&&r.hasEmptyObjectVals(st)&&r.checkFilters(),null!==r.settings.dataRaw?r.processData(e,a,q,o):q.done(function(t){r.processData(e,a,t,o)})},resetDisabledFilterVals:function(){for(var t in this.writeDebug("resetDisabledFilterVals"),this.settings.taxonomyFilters)if(this.settings.taxonomyFilters.hasOwnProperty(t))for(var e=0;e<this.settings.taxonomyFilters[t].length;e++)B("#"+this.settings.taxonomyFilters[t]+" input,option").each(function(){void 0!==B(this).attr("disabled")&&B(this).removeAttr("disabled")})},getAvailableFilters:function(t){this.writeDebug("getAvailableFilters");var e,s,i,n=[];for(e in Y)if(Y.hasOwnProperty(e))for(var a in Y[e])st.hasOwnProperty(a)&&""!==Y[e][a]&&(n.hasOwnProperty(a)?(s=n[a].concat(",",Y[e][a].replace(", ",",").trim()),n[a]=Array.from(new Set(s.split(","))).toString()):n[a]=Y[e][a].replace(", ",",").trim());for(i in st)n.hasOwnProperty(i)||(n[i]="");t(n)},maybeDisableFilterOptions:function(){this.writeDebug("maybeDisableFilterOptions");var i=[],n=this;this.resetDisabledFilterVals(),this.getAvailableFilters(function(t){for(var e in i=t,void 0===o&&(o=i),n.settings.taxonomyFilters)if(n.settings.taxonomyFilters.hasOwnProperty(e))for(var s=0;s<n.settings.taxonomyFilters[e].length;s++)n.settings.taxonomyFilters.hasOwnProperty(e)&&B("#"+n.settings.taxonomyFilters[e]+" input, #"+n.settings.taxonomyFilters[e]+" option").each(function(){""===B(this).val()||Array.from(new Set(i[e].split(","))).includes(B(this).val())||(u.hasOwnProperty(e)||(u[e]=[]),!(void 0!==K&&""!==K||"OPTION"!==B(this).prop("tagName")&&"radio"!==B(this).prop("type"))&&n.hasSingleGroupFilterVal(st,e)&&Array.from(new Set(o[e].split(","))).includes(B(this).val()))||!(void 0===K&&""===K||"OPTION"!==B(this).prop("tagName")&&"radio"!==B(this).prop("type"))&&n.hasSingleGroupFilterVal(st,e)&&Array.from(new Set(o[e].split(","))).includes(B(this).val())&&1===n.countFilters()||("OPTION"===B(this).prop("tagName")||"radio"===B(this).prop("type"))&&n.hasSingleGroupFilterVal(st,e)&&1<n.countFilters()&&Array.from(new Set(o[e].split(","))).includes(B(this).val())&&!u[e].includes(B(this).val())||(u.hasOwnProperty(e)&&Array.isArray(u[e])&&!u[e].includes(B(this).val())&&u[e].push(B(this).val()),B(this).attr("disabled",!0))})})},processData:function(t,e,s,i){this.writeDebug("processData",arguments);var n,a,o,r,l,g,c,h,u,d,p=this,m=0,f={},b=B("#"+p.settings.lengthSwapID),y=(this.isEmptyObject(t)||(n=t.lat,a=t.lng,o=t.origin,t.name,r=t.distance),B("#"+p.settings.mapID)),v="km"===p.settings.lengthUnit?p.settings.kilometersLang:p.settings.milesLang;if(V=q,void 0!==o&&(Q=o),p.settings.callbackSuccess&&p.settings.callbackSuccess.call(this,t,e,s,i),F=y.hasClass("bh-sl-map-open"),!0===p.settings.fullMapStart&&!1===F||!0===p.settings.autoGeocode&&!1===F||!0===p.settings.defaultLoc&&!1===F?W=!0:(!0===p.settings.fullMapStart&&!0===J||!0===p.settings.autoGeocode&&!0===J||p.settings.defaultLoc,p.reset()),y.addClass("bh-sl-map-open"),"json"===p.settings.dataType||"jsonp"===p.settings.dataType)for(var D=0;m<s.length;D++){var w,k=s[D],L={};for(w in k)k.hasOwnProperty(w)&&(L[w]=k[w]);p.locationsSetup(L,n,a,o,r),m++}else"kml"===p.settings.dataType?B(s).find("Placemark").each(function(){var t={name:B(this).find("name").text(),lat:B(this).find("coordinates").text().split(",")[1],lng:B(this).find("coordinates").text().split(",")[0],description:B(this).find("description").text()};p.locationsSetup(t,n,a,o,r),m++}):B(s).find(p.settings.xmlElement).each(function(){var t,e={};for(t in this.attributes)this.attributes.hasOwnProperty(t)&&(e[this.attributes[t].name]=this.attributes[t].value);p.locationsSetup(e,n,a,o,r),m++});if(!0===p.settings.nameSearch){if(void 0!==U&&""!==U)if(p.settings.nameAttribute.indexOf(",")){$=p.settings.nameAttribute.split(","),null!==p.settings.exclusiveTax?p.settings.exclusiveTax.concat($):p.settings.exclusiveTax=$;for(var S=0;S<$.length;S++)st[$[S].trim()]=[U]}else st[p.settings.nameAttribute]=[U];if(void 0!==U&&""===U)if(void 0!==$)for(var M=0;M<$.length;M++)$[M]in st&&delete st[$[M]];else delete st[p.settings.nameAttribute]}if(null!==p.settings.taxonomyFilters||!0===p.settings.nameSearch){for(var C in st)if(st.hasOwnProperty(C)&&0<st[C].length)for(var I=0;I<st[C].length;I++)f[C]||(f[C]=[]),void 0!==$?-1!==$.indexOf(C)?f[C][I]="(?:^|\\s)"+st[C][I].replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,""):f[C][I]="(?=.*"+st[C][I].replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,"")+"(?!\\s))":C===p.settings.nameAttribute?f[C][I]="(?:^|\\s)"+st[C][I].replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,""):f[C][I]="(?=.*"+st[C][I].replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,"")+"(?!\\s))";p.isEmptyObject(f)||(Y=B.grep(Y,function(t){return p.filterData(t,f)}))}if(null!==p.settings.sortBy&&"object"==typeof p.settings.sortBy)!0===p.settings.openNearest&&void 0!==Q&&(this.sortNumerically(Y,!0),void 0!==Y[0])&&(d=this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?Y[Y.length-1]:Y[0]),p.sortCustom(Y);else{if(void 0!==o&&p.sortNumerically(Y),p.isEmptyObject(f))if(!0===p.settings.maxDistance&&r)(void 0===Y[0]||Y[0].distance>r)&&p.notify(p.settings.distanceErrorAlert+r+" "+v);else{if(void 0===Y[0])throw p.emptyResult(),new Error("No locations found. Please check the dataLocation setting and path.");-1!==p.settings.distanceAlert&&Y[0].distance>p.settings.distanceAlert&&(void 0===Z||1===parseInt(Z))&&(p.notify(p.settings.distanceErrorAlert+p.settings.distanceAlert+" "+v),h=!0)}void 0!==Y[0]&&(d=Y[0])}if(!0===p.settings.featuredLocations&&(X=B.grep(Y,function(t){if(t.hasOwnProperty("featured"))return"true"===t.featured}),X=p.featuredRestrictions(t),tt=B.grep(Y,function(t){if(t.hasOwnProperty("featured"))return"true"!==t.featured}),Y=[],Y=X.concat(tt)),(!0!==W&&!1===p.settings.exclusiveFiltering||!0===p.settings.fullMapStart&&!1===p.settings.exclusiveFiltering||!0===p.settings.defaultLoc&&!1===p.settings.exclusiveFiltering)&&p.maybeDisableFilterOptions(),!0===p.settings.slideMap&&_.slideDown(),!0===p.settings.pagination&&p.paginationSetup(i),!0===p.settings.altDistanceNoResult&&d.distance>p.settings.distanceAlert)p.emptyResult();else if(p.isEmptyObject(Y)||"none"===Y[0].result)p.emptyResult();else{p.modalWindow(),H=-1===p.settings.storeLimit||Y.length<p.settings.storeLimit||!0===this.settings.fullMapStart&&!0===W&&(!isNaN(this.settings.fullMapStartListLimit)||26<this.settings.fullMapStartListLimit||-1===this.settings.fullMapStartListLimit)?Y.length:p.settings.storeLimit,!0!==p.settings.fullMapStart||!p.isEmptyObject(f)||""!==U&&void 0!==U||""!==K&&void 0!==K||(H=Y.length),!0===p.settings.pagination?(c=p.settings.locationsPerPage,(g=i*p.settings.locationsPerPage)+c>Y.length&&(c=p.settings.locationsPerPage-(g+c-Y.length)),Y=Y.slice(g,g+c),H=Y.length):(c=H,g=0),p.resultsTotalCount(Y.length),!0===p.settings.fullMapStart&&!0===W&&!0!==p.settings.querystringParams||0===p.settings.mapSettings.zoom||void 0===o||!0===h||!0===p.settings.maxDistance&&!1===W&&0<this.countFilters()?(P=p.settings.mapSettings,l=new google.maps.LatLngBounds):P=(!0===p.settings.pagination?(F=new google.maps.LatLng(Y[0].lat,Y[0].lng),p.settings.mapSettings.center=0===i?e:F):p.settings.mapSettings.center=e,p.settings.mapSettings),p.map=new google.maps.Map(j.getElementById(p.settings.mapID),P),N.addEventListener("resize",function(){var t=p.map.getCenter();google.maps.event.trigger(p.map,"resize"),p.map.setCenter(t)}),!0===p.settings.dragSearch&&p.map.addListener("dragend",function(){p.dragSearch(p.map)}),_.data(p.settings.mapID.replace("#",""),p.map),p.settings.callbackMapSet&&p.settings.callbackMapSet.call(this,p.map,e,z,P),u="undefined"!=typeof InfoBubble&&null!==p.settings.infoBubble?((y=p.settings.infoBubble).map=p.map,new InfoBubble(y)):new google.maps.InfoWindow,p.originMarker(p.map,o,e),B(j).on("click."+nt,".bh-sl-pagination li a",function(t){t.preventDefault(),p.paginationChange(B(this).parent().attr("data-page"))}),p.inlineDirections(p.map,o);for(var x,F,P,R=0;R<=c-1;R++){var O="",O=0<i?String.fromCharCode("A".charCodeAt(0)+(g+R)):String.fromCharCode("A".charCodeAt(0)+R),A=new google.maps.LatLng(Y[R].lat,Y[R].lng);if((O=p.createMarker(A,Y[R].name,Y[R].address,O,p.map,Y[R].category)).bhslID=R,et[R]=O,Y[R].markerid=O.bhslID,null!==this.settings.dataRaw)for(var G=0;G<this.settings.dataRaw.length;G++)this.settings.dataRaw[G]&&this.settings.dataRaw[G].hasOwnProperty("id")&&this.settings.dataRaw[G].id===Y[R].id&&(this.settings.dataRaw[G].markerid=Y[R].markerid);(!0===p.settings.fullMapStart&&!0===W&&!0!==p.settings.querystringParams||0===p.settings.mapSettings.zoom||void 0===o||!0===h||!0===p.settings.maxDistance&&!1===W&&0<this.countFilters())&&l.extend(A),p.createInfowindow(O,null,u,g,i)}if((!0===p.settings.fullMapStart&&!0===W&&!0!==p.settings.querystringParams||0===p.settings.mapSettings.zoom||void 0===o||!0===h||!0===p.settings.maxDistance&&!1===W&&0<this.countFilters())&&(p.map.fitBounds(l),x=google.maps.event.addListener(p.map,"idle",function(){16<p.map.getZoom()&&p.map.setZoom(16),google.maps.event.removeListener(x)})),B("."+p.settings.locationList+" ul").empty(),W&&!1!==p.settings.fullMapStartListLimit&&!isNaN(p.settings.fullMapStartListLimit)&&-1!==p.settings.fullMapStartListLimit&&et.length>p.settings.fullMapStartListLimit)for(var T=0;T<p.settings.fullMapStartListLimit;T++){var E=et[T];p.listSetup(E,g,i)}else B(et).each(function(t){t=et[t];p.listSetup(t,g,i)});b.length&&(p.lengthUnitSwap(b),b.on("change."+nt,function(t){t.stopPropagation(),p.lengthUnitSwap(b)})),p.openNearestLocation(d,u,g,i),"undefined"!=typeof markerClusterer&&(v=p.settings.markerCluster,new markerClusterer.MarkerClusterer({markers:et,map:p.map,customClustererParams:v})),p.listClick(p.map,u,g,i),B("."+p.settings.locationList+" ul > li:even").css("background",p.settings.listColor1),B("."+p.settings.locationList+" ul > li:odd").css("background",p.settings.listColor2),p.visibleMarkersList(p.map,et),!0===p.settings.querystringParams&&(F=B("#"+p.settings.addressID),P=B("#"+p.settings.searchID),void 0!==it&&it.hasOwnProperty("origin")&&""===F.val()&&F.val(it.origin),void 0!==it)&&it.hasOwnProperty("name")&&""===P.val()&&P.val(it.name),!0===p.settings.modal&&p.settings.callbackModalReady&&p.settings.callbackModalReady.call(this,t),p.settings.callbackFilters&&p.settings.callbackFilters.call(this,st,t)}},writeDebug:function(){N.console&&this.settings.debug&&(Function.prototype.bind?this.writeDebug=Function.prototype.bind.call(console.log,console,"StoreLocator :"):this.writeDebug=function(){arguments[0]="StoreLocator : "+arguments[0],Function.prototype.apply.call(console.log,console,arguments)},this.writeDebug.apply(this,arguments))}}),B.fn[nt]=function(e){var s,i=arguments;return e===t||"object"==typeof e?this.each(function(){B.data(this,"plugin_"+nt)||B.data(this,"plugin_"+nt,new p(this,e))}):"string"==typeof e&&"_"!==e[0]&&"init"!==e?(this.each(function(){var t=B.data(this,"plugin_"+nt);t instanceof p&&"function"==typeof t[e]&&(s=t[e].apply(t,Array.prototype.slice.call(i,1))),"destroy"===e&&B.data(this,"plugin_"+nt,null)}),s!==t?s:this):void 0})}(jQuery,window,document);