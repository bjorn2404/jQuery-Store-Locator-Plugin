/*! jQuery Google Maps Store Locator - v3.1.5 - 2021-09-27
* http://www.bjornblog.com/web/jquery-store-locator-plugin
* Copyright (c) 2021 Bjorn Holine; Licensed MIT */

!function(A,B,G,t){"use strict";var E,a,r,c,_,N,j,z,Q,l,g,h,q,i,n,s,o,U,V,H,K,W,J,Z,u,d,p,m,$="storeLocator";function f(t,e){E=A(t),this.element=t,this.settings=A.extend({},m,e),this._defaults=m,this._name=$,this.init()}void 0===A.fn[$]&&"undefined"!=typeof google&&(m={ajaxData:null,altDistanceNoResult:!(p={}),autoComplete:!(d={}),autoCompleteDisableListener:!(u={}),autoCompleteOptions:{},autoGeocode:!(Z={}),bounceMarker:!0,catMarkers:null,dataLocation:"data/locations.json",dataRaw:null,dataType:"json",debug:!(J=[]),defaultLat:null,defaultLng:null,defaultLoc:!(W=[]),disableAlphaMarkers:!(K=[]),distanceAlert:60,dragSearch:!(H=[]),exclusiveFiltering:!1,exclusiveTax:null,featuredDistance:null,featuredLocations:!1,fullMapStart:!1,fullMapStartBlank:!1,fullMapStartListLimit:!1,infoBubble:null,inlineDirections:!1,lengthUnit:"m",listColor1:"#ffffff",listColor2:"#eeeeee",loading:!1,locationsPerPage:10,mapSettings:{mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:12},markerCluster:null,markerImg:null,markerDim:null,maxDistance:!1,modal:!1,nameAttribute:"name",nameSearch:!1,noForm:!1,openNearest:!1,originMarker:!1,originMarkerDim:null,originMarkerImg:null,pagination:!1,querystringParams:!1,selectedMarkerImg:null,selectedMarkerImgDim:null,sessionStorage:!1,slideMap:!0,sortBy:null,storeLimit:26,taxonomyFilters:null,visibleMarkersList:!1,xmlElement:"marker",addressID:"bh-sl-address",closeIcon:"bh-sl-close-icon",formContainer:"bh-sl-form-container",formID:"bh-sl-user-location",geocodeID:null,lengthSwapID:"bh-sl-length-swap",loadingContainer:"bh-sl-loading",locationList:"bh-sl-loc-list",mapID:"bh-sl-map",maxDistanceID:"bh-sl-maxdistance",modalContent:"bh-sl-modal-content",modalWindow:"bh-sl-modal-window",orderID:"bh-sl-order",overlay:"bh-sl-overlay",regionID:"bh-sl-region",searchID:"bh-sl-search",sortID:"bh-sl-sort",taxonomyFiltersContainer:"bh-sl-filters-container",infowindowTemplatePath:"assets/js/plugins/storeLocator/templates/infowindow-description.html",listTemplatePath:"assets/js/plugins/storeLocator/templates/location-list-description.html",KMLinfowindowTemplatePath:"assets/js/plugins/storeLocator/templates/kml-infowindow-description.html",KMLlistTemplatePath:"assets/js/plugins/storeLocator/templates/kml-location-list-description.html",listTemplateID:null,infowindowTemplateID:null,callbackAutoGeoSuccess:null,callbackBeforeSend:null,callbackCloseDirections:null,callbackCreateMarker:null,callbackDirectionsRequest:null,callbackFilters:null,callbackFormVals:null,callbackGeocodeRestrictions:null,callbackJsonp:null,callbackListClick:null,callbackMapSet:null,callbackMarkerClick:null,callbackModalClose:null,callbackModalOpen:null,callbackModalReady:null,callbackNearestLoc:null,callbackNoResults:null,callbackNotify:null,callbackOrder:null,callbackPageChange:null,callbackRegion:null,callbackSorting:null,callbackSuccess:null,addressErrorAlert:"Unable to find address",autoGeocodeErrorAlert:"Automatic location detection failed. Please fill in your address or zip code.",distanceErrorAlert:"Unfortunately, our closest location is more than ",kilometerLang:"kilometer",kilometersLang:"kilometers",mileLang:"mile",milesLang:"miles",noResultsTitle:"No results",noResultsDesc:"No locations were found with the given criteria. Please modify your selections or input.",nextPage:"Next &raquo;",prevPage:"&laquo; Prev"},A.extend(f.prototype,{init:function(){var t,e=this;this.writeDebug("init"),"km"===this.settings.lengthUnit?d.EarthRadius=6367:d.EarthRadius=3956,c="kml"===this.settings.dataType?"xml":this.settings.dataType,!0===this.settings.inlineDirections&&A("."+this.settings.locationList).prepend('<div class="bh-sl-directions-panel"></div>'),j=this.settings.mapSettings.zoom,Handlebars.registerHelper("niceURL",function(t){if(t)return t.replace("https://","").replace("http://","")}),null!==this.settings.taxonomyFilters&&this.taxonomyFiltering(),this.sorting(),this.order(),!0===this.settings.modal&&(null!==this.settings.taxonomyFilters&&A("."+this.settings.taxonomyFiltersContainer).clone(!0,!0).prependTo(E),E.wrap('<div class="'+this.settings.overlay+'"><div class="'+this.settings.modalWindow+'"><div class="'+this.settings.modalContent+'">'),A("."+this.settings.modalWindow).prepend('<div class="'+this.settings.closeIcon+'"></div>'),A("."+this.settings.overlay).hide()),!0===this.settings.autoComplete&&(t=G.getElementById(this.settings.addressID),t=new google.maps.places.Autocomplete(t,this.settings.autoCompleteOptions),!0===this.settings.autoComplete&&!0!==this.settings.autoCompleteDisableListener&&t.addListener("place_changed",function(t){e.processForm(t)})),this._loadTemplates()},destroy:function(){this.writeDebug("destroy"),this.reset();var t=A("#"+this.settings.mapID);if(J.length)for(var e=0;e<=J.length;e++)google.maps.event.removeListener(J[e]);A("."+this.settings.locationList+" ul").empty(),t.hasClass("bh-sl-map-open")&&t.empty().removeClass("bh-sl-map-open"),!0===this.settings.modal&&A(". "+this.settings.overlay).remove(),t.attr("style",""),E.hide(),A.removeData(E.get(0)),A(G).off($),E.unbind()},reset:function(){var t;this.writeDebug("reset"),K=[],H=[],W=[],U=!(J=[]),A(G).off("click."+$,"."+this.settings.locationList+" li"),A("."+this.settings.locationList+" .bh-sl-close-directions-container").length&&A(".bh-sl-close-directions-container").remove(),!0===this.settings.inlineDirections&&(0<(t=A("."+this.settings.locationList+" .adp")).length&&(t.remove(),A("."+this.settings.locationList+" ul").fadeIn()),A(G).off("click","."+this.settings.locationList+" li .loc-directions a")),!0===this.settings.pagination&&A(G).off("click."+$,".bh-sl-pagination li")},formFiltersReset:function(){var t,e;this.writeDebug("formFiltersReset"),null!==this.settings.taxonomyFilters&&(t=A("."+this.settings.taxonomyFiltersContainer+" input"),e=A("."+this.settings.taxonomyFiltersContainer+" select"),"object"==typeof t&&(t.each(function(){(A(this).is('input[type="checkbox"]')||A(this).is('input[type="radio"]'))&&A(this).prop("checked",!1)}),e.each(function(){A(this).prop("selectedIndex",0)})))},mapReload:function(){this.writeDebug("mapReload"),this.reset(),V=!0,null!==this.settings.taxonomyFilters&&(this.formFiltersReset(),this.taxonomyFiltersInit()),g&&h?(this.settings.mapSettings.zoom=j,this.processForm()):this.mapping(p)},notify:function(t){this.writeDebug("notify",t),this.settings.callbackNotify?this.settings.callbackNotify.call(this,t):alert(t)},geoCodeCalcToRadian:function(t){return this.writeDebug("geoCodeCalcToRadian",t),t*(Math.PI/180)},geoCodeCalcDiffRadian:function(t,e){return this.writeDebug("geoCodeCalcDiffRadian",arguments),this.geoCodeCalcToRadian(e)-this.geoCodeCalcToRadian(t)},geoCodeCalcCalcDistance:function(t,e,s,i,n){return this.writeDebug("geoCodeCalcCalcDistance",arguments),2*n*Math.asin(Math.min(1,Math.sqrt(Math.pow(Math.sin(this.geoCodeCalcDiffRadian(t,s)/2),2)+Math.cos(this.geoCodeCalcToRadian(t))*Math.cos(this.geoCodeCalcToRadian(s))*Math.pow(Math.sin(this.geoCodeCalcDiffRadian(e,i)/2),2))))},getQueryString:function(t){if(this.writeDebug("getQueryString",t),t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}},getMap:function(){return this.map},_loadTemplates:function(){var e;this.writeDebug("_loadTemplates");var t=this,s='<div class="bh-sl-error">Error: Could not load plugin templates. Check the paths and ensure they have been uploaded. Paths will be wrong if you do not run this from a web server.</div>';"kml"===this.settings.dataType&&null===this.settings.listTemplateID&&null===this.settings.infowindowTemplateID?A.when(A.get(this.settings.KMLinfowindowTemplatePath,function(t){e=t,r=Handlebars.compile(e)}),A.get(this.settings.KMLlistTemplatePath,function(t){e=t,a=Handlebars.compile(e)})).then(function(){t.locator()},function(){throw A("."+t.settings.formContainer).append(s),new Error("Could not load storeLocator plugin templates")}):null!==this.settings.listTemplateID&&null!==this.settings.infowindowTemplateID?(r=Handlebars.compile(A("#"+this.settings.infowindowTemplateID).html()),a=Handlebars.compile(A("#"+this.settings.listTemplateID).html()),t.locator()):A.when(A.get(this.settings.infowindowTemplatePath,function(t){e=t,r=Handlebars.compile(e)}),A.get(this.settings.listTemplatePath,function(t){e=t,a=Handlebars.compile(e)})).then(function(){t.locator()},function(){throw A("."+t.settings.formContainer).append(s),new Error("Could not load storeLocator plugin templates")})},locator:function(){this.writeDebug("locator"),!0===this.settings.slideMap&&E.hide(),this._start(),this._formEventHandler()},_formEventHandler:function(){this.writeDebug("_formEventHandler");var e=this;!0===this.settings.noForm?(A(G).on("click."+$,"."+this.settings.formContainer+" button",function(t){e.processForm(t)}),A(G).on("keydown."+$,function(t){13===t.keyCode&&A("#"+e.settings.addressID).is(":focus")&&e.processForm(t)})):A(G).on("submit."+$,"#"+this.settings.formID,function(t){e.processForm(t)}),A(".bh-sl-reset").length&&A("#"+this.settings.mapID).length&&A(G).on("click."+$,".bh-sl-reset",function(){e.mapReload()})},_getData:function(t,e,s,i,n){this.writeDebug("_getData",arguments);var a=this,o="",r="",l="";if(void 0!==i&&void 0!==i.geometry.bounds&&(l=i.formatted_address,o=JSON.stringify(i.geometry.bounds.getNorthEast()),r=JSON.stringify(i.geometry.bounds.getSouthWest())),this.settings.callbackBeforeSend&&this.settings.callbackBeforeSend.call(this,t,e,s,l,o,r,n),null!==a.settings.dataRaw)return"xml"===c?A.parseXML(a.settings.dataRaw):"json"===c?Array.isArray&&Array.isArray(a.settings.dataRaw)?a.settings.dataRaw:"string"==typeof a.settings.dataRaw?JSON.parse(a.settings.dataRaw):[]:void 0;var g=A.Deferred();!0===this.settings.loading&&A("."+this.settings.formContainer).append('<div class="'+this.settings.loadingContainer+'"></div>');r={origLat:t,origLng:e,origAddress:s,formattedAddress:l,boundsNorthEast:o,boundsSouthWest:r};return null!==this.settings.ajaxData&&"object"==typeof this.settings.ajaxData&&A.extend(r,this.settings.ajaxData),A.ajax({type:"GET",url:this.settings.dataLocation+("jsonp"===this.settings.dataType?(this.settings.dataLocation.match(/\?/)?"&":"?")+"callback=?":""),data:r,dataType:c,jsonpCallback:"jsonp"===this.settings.dataType?this.settings.callbackJsonp:null}).done(function(t){g.resolve(t),!0===a.settings.loading&&A("."+a.settings.formContainer+" ."+a.settings.loadingContainer).remove()}).fail(g.reject),g.promise()},_start:function(){this.writeDebug("_start");var t,e,s=this,i=this.settings.autoGeocode;!1!==s.settings.fullMapStartBlank?(A("#"+s.settings.mapID).addClass("bh-sl-map-open"),(e=s.settings.mapSettings).zoom=s.settings.fullMapStartBlank,t=new google.maps.LatLng(this.settings.defaultLat,this.settings.defaultLng),e.center=t,s.map=new google.maps.Map(G.getElementById(s.settings.mapID),e),google.maps.event.addDomListener(B,"resize",function(){var t=s.map.getCenter();google.maps.event.trigger(s.map,"resize"),s.map.setCenter(t)}),s.settings.fullMapStartBlank=!1,e.zoom=j):(!0===this.settings.defaultLoc&&this.defaultLocation(),""!==A.trim(A("#"+this.settings.addressID).val())?(s.writeDebug("Using Address Field"),s.processForm(null),i=!1):!0===this.settings.fullMapStart&&(!0===this.settings.querystringParams&&this.getQueryString(this.settings.addressID)||!0===this.settings.querystringParams&&this.getQueryString(this.settings.searchID)||!0===this.settings.querystringParams&&this.getQueryString(this.settings.maxDistanceID)?(s.writeDebug("Using Query String"),this.processForm(null),i=!1):this.mapping(null))),!0===this.settings.autoGeocode&&!0===i&&(s.writeDebug("Auto Geo"),s.htmlGeocode()),null!==this.settings.autoGeocode&&(s.writeDebug("Button Geo"),A(G).on("click."+$,"#"+this.settings.geocodeID,function(){s.htmlGeocode()}))},htmlGeocode:function(){this.writeDebug("htmlGeocode",arguments);var e=this;if(!0===e.settings.sessionStorage&&B.sessionStorage&&B.sessionStorage.getItem("myGeo"))return e.writeDebug("Using Session Saved Values for GEO"),e.autoGeocodeQuery(JSON.parse(B.sessionStorage.getItem("myGeo"))),!1;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){e.writeDebug("Current Position Result");t={coords:{latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy}};!0===e.settings.sessionStorage&&B.sessionStorage&&B.sessionStorage.setItem("myGeo",JSON.stringify(t)),e.settings.callbackAutoGeoSuccess&&e.settings.callbackAutoGeoSuccess.call(this,t),e.autoGeocodeQuery(t)},function(t){e._autoGeocodeError(t)})},googleGeocode:function(t){t.writeDebug("googleGeocode",arguments);var e=new google.maps.Geocoder;this.geocode=function(t,s){e.geocode(t,function(t,e){if(e!==google.maps.GeocoderStatus.OK)throw s(null),new Error("Geocode was not successful for the following reason: "+e);e={};e.latitude=t[0].geometry.location.lat(),e.longitude=t[0].geometry.location.lng(),e.geocodeResult=t[0],s(e)})}},reverseGoogleGeocode:function(t){t.writeDebug("reverseGoogleGeocode",arguments);var e=new google.maps.Geocoder;this.geocode=function(t,s){e.geocode(t,function(t,e){if(e!==google.maps.GeocoderStatus.OK)throw s(null),new Error("Reverse geocode was not successful for the following reason: "+e);t[0]&&((e={}).address=t[0].formatted_address,e.fullResult=t[0],s(e))})}},roundNumber:function(t,e){return this.writeDebug("roundNumber",arguments),Math.round(t*Math.pow(10,e))/Math.pow(10,e)},isEmptyObject:function(t){for(var e in this.writeDebug("isEmptyObject",arguments),t)if(t.hasOwnProperty(e))return!1;return!0},hasEmptyObjectVals:function(t){this.writeDebug("hasEmptyObjectVals",arguments);var e,s=!0;for(e in t)t.hasOwnProperty(e)&&""!==t[e]&&0!==t[e].length&&(s=!1);return s},modalClose:function(){this.writeDebug("modalClose"),this.settings.callbackModalClose&&this.settings.callbackModalClose.call(this),Z={},A("."+this.settings.overlay+" select").prop("selectedIndex",0),A("."+this.settings.overlay+" input").prop("checked",!1),A("."+this.settings.overlay).hide()},_createLocationVariables:function(t){var e,s;for(s in this.writeDebug("_createLocationVariables",arguments),u={},K[t])K[t].hasOwnProperty(s)&&(e=K[t][s],"distance"!==s&&"altdistance"!==s||(e=this.roundNumber(e,2)),u[s]=e)},sortAlpha:function(t){this.writeDebug("sortAlpha",arguments);var s=this.settings.sortBy.hasOwnProperty("prop")&&void 0!==this.settings.sortBy.prop?this.settings.sortBy.prop:"name";this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?t.sort(function(t,e){return e[s].toLowerCase().localeCompare(t[s].toLowerCase())}):t.sort(function(t,e){return t[s].toLowerCase().localeCompare(e[s].toLowerCase())})},sortDate:function(t){this.writeDebug("sortDate",arguments);var s=this.settings.sortBy.hasOwnProperty("prop")&&void 0!==this.settings.sortBy.prop?this.settings.sortBy.prop:"date";this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?t.sort(function(t,e){return new Date(e[s]).getTime()-new Date(t[s]).getTime()}):t.sort(function(t,e){return new Date(t[s]).getTime()-new Date(e[s]).getTime()})},sortNumerically:function(t){this.writeDebug("sortNumerically",arguments);var s=null!==this.settings.sortBy&&this.settings.sortBy.hasOwnProperty("prop")&&void 0!==this.settings.sortBy.prop?this.settings.sortBy.prop:"distance";null!==this.settings.sortBy&&this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?t.sort(function(t,e){return e[s]<t[s]?-1:e[s]>t[s]?1:0}):t.sort(function(t,e){return t[s]<e[s]?-1:t[s]>e[s]?1:0})},sortCustom:function(t){this.writeDebug("sortCustom",arguments),this.settings.sortBy.hasOwnProperty("method")&&"alpha"===this.settings.sortBy.method.toString()?this.sortAlpha(t):this.settings.sortBy.hasOwnProperty("method")&&"date"===this.settings.sortBy.method.toString()?this.sortDate(t):this.sortNumerically(t)},filterMatching:function(t,e,s){return this.writeDebug("inclusiveFilter",arguments),void 0!==e&&(t=!0===(s=void 0===s||s)?t.join(""):t.join("|"),!!new RegExp(t,"i").test(e.replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,"")))},filterData:function(t,e){this.writeDebug("filterData",arguments);var s,i=!0;for(s in e)if(e.hasOwnProperty(s)){for(var n=[],a=0;a<e[s].length;a++)!0===this.settings.exclusiveFiltering||null!==this.settings.exclusiveTax&&Array.isArray(this.settings.exclusiveTax)&&-1!==this.settings.exclusiveTax.indexOf(s)?n[a]=this.filterMatching(e[s],t[s],!1):n[a]=this.filterMatching(e[s],t[s]);-1===n.indexOf(!0)&&(i=!1)}return i},_paginationOutput:function(t,e){this.writeDebug("_paginationOutput",arguments);var s="",i=(t=parseFloat(t))+1;0<t&&(s+='<li class="bh-sl-next-prev" data-page="'+(t-1)+'">'+this.settings.prevPage+"</li>");for(var n=0;n<Math.ceil(e);n++){var a=n+1;s+=n===t?'<li class="bh-sl-current" data-page="'+n+'">'+a+"</li>":'<li data-page="'+n+'">'+a+"</li>"}return i<e&&(s+='<li class="bh-sl-next-prev" data-page="'+i+'">'+this.settings.nextPage+"</li>"),s},paginationSetup:function(t){this.writeDebug("paginationSetup",arguments);var e="",s=A(".bh-sl-pagination-container .bh-sl-pagination"),i=-1===this.settings.storeLimit||K.length<this.settings.storeLimit?K.length/this.settings.locationsPerPage:this.settings.storeLimit/this.settings.locationsPerPage;void 0===t&&(t=0),e=(0===s.length||s.empty(),this._paginationOutput(t,i)),s.append(e)},markerImage:function(t,e,s){return this.writeDebug("markerImage",arguments),void 0!==e&&void 0!==s?{url:t,size:new google.maps.Size(e,s),scaledSize:new google.maps.Size(e,s)}:{url:t,size:new google.maps.Size(32,32),scaledSize:new google.maps.Size(32,32)}},createMarker:function(t,e,s,i,n,a){var o;this.writeDebug("createMarker",arguments);var r;if(null!==this.settings.catMarkers&&void 0!==a)if(-1!==a.indexOf(",")){r=a.split(",");for(var l=0;l<r.length;l++)r[l]in this.settings.catMarkers&&(o=this.markerImage(this.settings.catMarkers[r[l]][0],parseInt(this.settings.catMarkers[r[l]][1]),parseInt(this.settings.catMarkers[r[l]][2])))}else a in this.settings.catMarkers&&(o=this.markerImage(this.settings.catMarkers[a][0],parseInt(this.settings.catMarkers[a][1]),parseInt(this.settings.catMarkers[a][2])));return null!==this.settings.markerImg&&(o=null===this.settings.markerDim?this.markerImage(this.settings.markerImg):this.markerImage(this.settings.markerImg,this.settings.markerDim.width,this.settings.markerDim.height)),this.settings.callbackCreateMarker?this.settings.callbackCreateMarker.call(this,n,t,i,a):!0===this.settings.disableAlphaMarkers||-1===this.settings.storeLimit||26<this.settings.storeLimit||null!==this.settings.catMarkers||null!==this.settings.markerImg||!0===this.settings.fullMapStart&&!0===U&&(isNaN(this.settings.fullMapStartListLimit)||26<this.settings.fullMapStartListLimit||-1===this.settings.fullMapStartListLimit)?new google.maps.Marker({position:t,map:n,draggable:!1,icon:o}):(i={url:"https://mt.googleapis.com/vt/icon/name=icons/spotlight/spotlight-waypoint-b.png&text="+i+"&psize=16&font=fonts/Roboto-Regular.ttf&color=ff333333&ax=44&ay=48"},new google.maps.Marker({position:t,map:n,icon:i,draggable:!1}))},_defineLocationData:function(t,e,s){this.writeDebug("_defineLocationData",arguments);var i,n,a="";this._createLocationVariables(t.get("id")),i=u.distance<=1?"km"===this.settings.lengthUnit?(n=this.settings.kilometerLang,this.settings.mileLang):(n=this.settings.mileLang,this.settings.kilometerLang):"km"===this.settings.lengthUnit?(n=this.settings.kilometersLang,this.settings.milesLang):(n=this.settings.milesLang,this.settings.kilometersLang);t=t.get("id"),a=!0===this.settings.disableAlphaMarkers||-1===this.settings.storeLimit||26<this.settings.storeLimit||!0===this.settings.fullMapStart&&!0===U&&(isNaN(this.settings.fullMapStartListLimit)||26<this.settings.fullMapStartListLimit||-1===this.settings.fullMapStartListLimit)?t+1:0<s?String.fromCharCode("A".charCodeAt(0)+(e+t)):String.fromCharCode("A".charCodeAt(0)+t);return{location:[A.extend(u,{markerid:t,marker:a,altlength:i,length:n,origin:_})]}},listSetup:function(t,e,s){this.writeDebug("listSetup",arguments);s=this._defineLocationData(t,e,s),s=a(s);A("."+this.settings.locationList+" > ul").append(s)},changeSelectedMarker:function(t){var e;void 0!==o&&o.setIcon(s),e=null===this.settings.selectedMarkerImgDim?this.markerImage(this.settings.selectedMarkerImg):this.markerImage(this.settings.selectedMarkerImg,this.settings.selectedMarkerImgDim.width,this.settings.selectedMarkerImgDim.height),s=t.icon,t.setIcon(e),o=t},createInfowindow:function(s,t,i,e,n){this.writeDebug("createInfowindow",arguments);var a=this,n=this._defineLocationData(s,e,n),o=r(n);"left"===t?(i.setContent(o),i.open(s.get("map"),s)):google.maps.event.addListener(s,"click",function(){i.setContent(o),i.open(s.get("map"),s);var t=s.get("id"),e=A("."+a.settings.locationList+" li[data-markerid="+t+"]");0<e.length&&(a.settings.callbackMarkerClick&&a.settings.callbackMarkerClick.call(this,s,t,e,K[t],a.map),A("."+a.settings.locationList+" li").removeClass("list-focus"),e.addClass("list-focus"),(t=A("."+a.settings.locationList)).animate({scrollTop:e.offset().top-t.offset().top+t.scrollTop()})),null!==a.settings.selectedMarkerImg&&a.changeSelectedMarker(s)})},autoGeocodeQuery:function(e){this.writeDebug("autoGeocodeQuery",arguments);var s,i=this,n=null,t=A("#"+this.settings.maxDistanceID);!0===this.settings.querystringParams&&this.getQueryString(this.settings.maxDistanceID)?(n=this.getQueryString(this.settings.maxDistanceID),""!==t.val()&&(n=t.val())):!0===this.settings.maxDistance&&(n=t.val()||"");var a=new this.reverseGoogleGeocode(this),t=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);a.geocode({latLng:t},function(t){null!==t?(s=l=t.address,g=p.lat=e.coords.latitude,h=p.lng=e.coords.longitude,p.origin=s,p.distance=n,i.mapping(p),void 0!==s&&A("#"+i.settings.addressID).val(s)):i.notify(i.settings.addressErrorAlert)})},_autoGeocodeError:function(){this.writeDebug("_autoGeocodeError"),this.notify(this.settings.autoGeocodeErrorAlert)},defaultLocation:function(){this.writeDebug("defaultLocation");var e,s=this,i=null,t=A("#"+this.settings.maxDistanceID);!0===this.settings.querystringParams&&this.getQueryString(this.settings.maxDistanceID)?(i=this.getQueryString(this.settings.maxDistanceID),""!==t.val()&&(i=t.val())):!0===this.settings.maxDistance&&(i=t.val()||"");var n=new this.reverseGoogleGeocode(this),t=new google.maps.LatLng(this.settings.defaultLat,this.settings.defaultLng);n.geocode({latLng:t},function(t){null!==t?(e=l=t.address,g=p.lat=s.settings.defaultLat,h=p.lng=s.settings.defaultLng,p.distance=i,p.origin=e,s.mapping(p)):s.notify(s.settings.addressErrorAlert)})},paginationChange:function(t){this.writeDebug("paginationChange",arguments),this.settings.callbackPageChange&&this.settings.callbackPageChange.call(this,t),p.page=t,this.mapping(p)},getAddressByMarker:function(t){this.writeDebug("getAddressByMarker",arguments);var e="";return K[t].address&&(e+=K[t].address+" "),K[t].address2&&(e+=K[t].address2+" "),K[t].city&&(e+=K[t].city+", "),K[t].state&&(e+=K[t].state+" "),K[t].postal&&(e+=K[t].postal+" "),K[t].country&&(e+=K[t].country+" "),e},clearMarkers:function(){this.writeDebug("clearMarkers");for(var t=null,t=K.length<this.settings.storeLimit?K.length:this.settings.storeLimit,e=0;e<t;e++)J[e].setMap(null)},directionsRequest:function(t,e,s){this.writeDebug("directionsRequest",arguments),this.settings.callbackDirectionsRequest&&this.settings.callbackDirectionsRequest.call(this,t,e,s,K[e]);e=this.getAddressByMarker(e);e&&(A("."+this.settings.locationList+" ul").hide(),this.clearMarkers(),null!=i&&(i.setMap(null),i=null),i=new google.maps.DirectionsRenderer,n=new google.maps.DirectionsService,i.setMap(s),i.setPanel(A(".bh-sl-directions-panel").get(0)),e={origin:t,destination:e,travelMode:google.maps.TravelMode.DRIVING},n.route(e,function(t,e){e===google.maps.DirectionsStatus.OK&&i.setDirections(t)}),A("."+this.settings.locationList).prepend('<div class="bh-sl-close-directions-container"><div class="'+this.settings.closeIcon+'"></div></div>')),A(G).off("click","."+this.settings.locationList+" li .loc-directions a")},closeDirections:function(){this.writeDebug("closeDirections"),this.settings.callbackCloseDirections&&this.settings.callbackCloseDirections.call(this),this.reset(),g&&h&&(0===this.countFilters()?this.settings.mapSettings.zoom=j:this.settings.mapSettings.zoom=0,this.processForm(null)),A(G).off("click."+$,"."+this.settings.locationList+" .bh-sl-close-icon")},lengthUnitSwap:function(t){this.writeDebug("lengthUnitSwap",arguments),"alt-distance"===t.val()?(A("."+this.settings.locationList+" .loc-alt-dist").show(),A("."+this.settings.locationList+" .loc-default-dist").hide()):"default-distance"===t.val()&&(A("."+this.settings.locationList+" .loc-default-dist").show(),A("."+this.settings.locationList+" .loc-alt-dist").hide())},processForm:function(t){this.writeDebug("processForm",arguments);var e=this,s=null,i={},n=A("#"+this.settings.addressID),a=A("#"+this.settings.searchID),o=A("#"+this.settings.maxDistanceID),r="";null!=t&&t.preventDefault(),A("."+e.settings.formContainer+" input, ."+e.settings.formContainer+" select").blur(),!0===this.settings.querystringParams&&(this.getQueryString(this.settings.addressID)||this.getQueryString(this.settings.searchID)||this.getQueryString(this.settings.maxDistanceID))?(l=this.getQueryString(this.settings.addressID),Q=this.getQueryString(this.settings.searchID),s=this.getQueryString(this.settings.maxDistanceID),""!==n.val()&&(l=n.val()),""!==a.val()&&(Q=a.val()),""!==o.val()&&(s=o.val())):(l=n.val()||"",Q=a.val()||"",!0===this.settings.maxDistance&&(s=o.val()||"")),r=this.settings.callbackRegion?this.settings.callbackRegion.call(this,l,Q,s):A("#"+this.settings.regionID).val(),this.settings.callbackFormVals&&this.settings.callbackFormVals.call(this,l,Q,s,r),void 0!==r&&(i={country:r}),"function"==typeof this.settings.callbackGeocodeRestrictions&&(i=this.settings.callbackGeocodeRestrictions.call(this,l,Q,s)),""===l&&""===Q&&!0!==this.settings.autoGeocode?this._start():""!==l?(""===Q&&Z.hasOwnProperty("name")&&delete Z.name,void 0!==_&&void 0!==g&&void 0!==h&&l===_?(p.lat=g,p.lng=h,p.origin=l,p.name=Q,p.distance=s,e.mapping(p)):new this.googleGeocode(this).geocode({address:l,componentRestrictions:i,region:r},function(t){null!==t?(g=t.latitude,h=t.longitude,p.lat=g,p.lng=h,p.origin=l,p.name=Q,p.distance=s,p.geocodeResult=t.geocodeResult,e.mapping(p)):e.notify(e.settings.addressErrorAlert)})):""!==Q?(""===l&&delete p.origin,p.name=Q,e.mapping(p)):!0===this.settings.autoGeocode&&(p.lat=g,p.lng=h,p.origin=l,p.name=Q,p.distance=s,e.mapping(p))},locationsSetup:function(t,e,s,i,n){this.writeDebug("locationsSetup",arguments),void 0!==i&&(t.distance||(t.distance=this.geoCodeCalcCalcDistance(e,s,t.lat,t.lng,d.EarthRadius),"m"===this.settings.lengthUnit?t.altdistance=1.609344*parseFloat(t.distance):"km"===this.settings.lengthUnit&&(t.altdistance=parseFloat(t.distance)/1.609344))),!0===this.settings.maxDistance&&null!=n?t.distance<=n&&K.push(t):(!0!==this.settings.maxDistance||!0!==this.settings.querystringParams||null==n||t.distance<=n)&&K.push(t)},sorting:function(){this.writeDebug("sorting",arguments);var s=this,i=A("#"+s.settings.mapID),t=A("#"+s.settings.sortID);0!==t.length&&t.on("change."+$,function(t){var e;t.stopPropagation(),!0===s.settings.pagination&&s.paginationChange(0),e=void 0!==A(this).find(":selected").attr("data-method")?A(this).find(":selected").attr("data-method"):"distance",t=A(this).val(),s.settings.sortBy.method=e,s.settings.sortBy.prop=t,s.settings.callbackSorting&&s.settings.callbackSorting.call(this,s.settings.sortBy),i.hasClass("bh-sl-map-open")&&s.mapping(p)})},order:function(){this.writeDebug("order",arguments);var e=this,s=A("#"+e.settings.mapID),t=A("#"+e.settings.orderID);0!==t.length&&t.on("change."+$,function(t){t.stopPropagation(),!0===e.settings.pagination&&e.paginationChange(0),e.settings.sortBy.order=A(this).val(),e.settings.callbackOrder&&e.settings.callbackOrder.call(this,e.settings.order),s.hasClass("bh-sl-map-open")&&e.mapping(p)})},countFilters:function(){this.writeDebug("countFilters");var t=0;if(!this.isEmptyObject(Z))for(var e in Z)Z.hasOwnProperty(e)&&(t+=Z[e].length);return t},_existingCheckedFilters:function(e){this.writeDebug("_existingCheckedFilters",arguments),A("#"+this.settings.taxonomyFilters[e]+" input[type=checkbox]").each(function(){var t;!A(this).prop("checked")||void 0!==(t=A(this).val())&&""!==t&&-1===Z[e].indexOf(t)&&Z[e].push(t)})},_existingSelectedFilters:function(e){this.writeDebug("_existingSelectedFilters",arguments),A("#"+this.settings.taxonomyFilters[e]+" select").each(function(){var t=A(this).val();void 0!==t&&""!==t&&-1===Z[e].indexOf(t)&&(Z[e]=[t])})},_existingRadioFilters:function(e){this.writeDebug("_existingRadioFilters",arguments),A("#"+this.settings.taxonomyFilters[e]+" input[type=radio]").each(function(){var t;!A(this).prop("checked")||void 0!==(t=A(this).val())&&""!==t&&-1===Z[e].indexOf(t)&&(Z[e]=[t])})},checkFilters:function(){for(var t in this.writeDebug("checkFilters"),this.settings.taxonomyFilters)this.settings.taxonomyFilters.hasOwnProperty(t)&&(this._existingCheckedFilters(t),this._existingSelectedFilters(t),this._existingRadioFilters(t))},selectQueryStringFilters:function(t,e){this.writeDebug("selectQueryStringFilters",arguments);var s=A("#"+this.settings.taxonomyFilters[t]);if(s.find('input[type="checkbox"]').length)for(var i=0;i<e.length;i++)s.find('input:checkbox[value="'+e[i]+'"]').prop("checked",!0);s.find("select").length&&s.find('option[value="'+e[0]+'"]').prop("selected",!0),s.find('input[type="radio"]').length&&s.find('input:radio[value="'+e[0]+'"]').prop("checked",!0)},checkQueryStringFilters:function(){for(var t in this.writeDebug("checkQueryStringFilters",arguments),Z){var e;Z.hasOwnProperty(t)&&(-1!==(e=this.getQueryString(t)).indexOf(",")&&(e=e.split(",")),void 0!==e&&""!==e&&-1===Z[t].indexOf(e)&&(Array.isArray(e)?Z[t]=e:Z[t]=[e]),Z[t].length&&this.selectQueryStringFilters(t,Z[t]))}},getFilterKey:function(t){for(var e in this.writeDebug("getFilterKey",arguments),this.settings.taxonomyFilters)if(this.settings.taxonomyFilters.hasOwnProperty(e))for(var s=0;s<this.settings.taxonomyFilters[e].length;s++)if(this.settings.taxonomyFilters[e]===t)return e},taxonomyFiltersInit:function(){for(var t in this.writeDebug("taxonomyFiltersInit"),this.settings.taxonomyFilters)this.settings.taxonomyFilters.hasOwnProperty(t)&&(Z[t]=[])},taxonomyFiltering:function(){this.writeDebug("taxonomyFiltering");var n=this;n.taxonomyFiltersInit(),n.checkQueryStringFilters(),A("."+this.settings.taxonomyFiltersContainer).on("change."+$,"input, select",function(t){var e,s,i;t.stopPropagation(),!0===n.settings.pagination&&n.paginationChange(0),A(this).is('input[type="checkbox"]')?(n.checkFilters(),e=A(this).val(),s=A(this).closest(".bh-sl-filters").attr("id"),(i=n.getFilterKey(s))&&(A(this).prop("checked")?(-1===Z[i].indexOf(e)&&Z[i].push(e),!0===A("#"+n.settings.mapID).hasClass("bh-sl-map-open")&&(g&&h?(n.settings.mapSettings.zoom=0,n.processForm()):n.mapping(p))):-1<(t=Z[i].indexOf(e))&&(Z[i].splice(t,1),!0===A("#"+n.settings.mapID).hasClass("bh-sl-map-open")&&(g&&h?(0===n.countFilters()?n.settings.mapSettings.zoom=j:n.settings.mapSettings.zoom=0,n.processForm()):n.mapping(p))))):(A(this).is("select")||A(this).is('input[type="radio"]'))&&(n.checkFilters(),e=A(this).val(),s=A(this).closest(".bh-sl-filters").attr("id"),i=n.getFilterKey(s),e?i&&(Z[i]=[e],!0===A("#"+n.settings.mapID).hasClass("bh-sl-map-open")&&(g&&h?(n.settings.mapSettings.zoom=0,n.processForm()):n.mapping(p))):(i&&(Z[i]=[]),n.reset(),g&&h?(n.settings.mapSettings.zoom=j,n.processForm()):n.mapping(p)))})},checkVisibleMarkers:function(t,s){this.writeDebug("checkVisibleMarkers",arguments);var i,n=this;A("."+this.settings.locationList+" ul").empty(),A(t).each(function(t,e){s.getBounds().contains(e.getPosition())&&(n.listSetup(e,0,0),i=a(void 0),A("."+n.settings.locationList+" > ul").append(i))}),A("."+this.settings.locationList+" ul li:even").css("background",this.settings.listColor1),A("."+this.settings.locationList+" ul li:odd").css("background",this.settings.listColor2)},dragSearch:function(t){this.writeDebug("dragSearch",arguments);var e=t.getCenter(),s=this;this.settings.mapSettings.zoom=t.getZoom(),g=p.lat=e.lat(),h=p.lng=e.lng();t=new this.reverseGoogleGeocode(this),e=new google.maps.LatLng(p.lat,p.lng);t.geocode({latLng:e},function(t){null!==t?(p.origin=l=t.address,s.mapping(p)):s.notify(s.settings.addressErrorAlert)})},emptyResult:function(){this.writeDebug("emptyResult",arguments);var t=A("."+this.settings.locationList+" ul"),e=this.settings.mapSettings;this.map=new google.maps.Map(G.getElementById(this.settings.mapID),e),this.settings.callbackNoResults&&this.settings.callbackNoResults.call(this,this.map,e),t.empty(),e=A('<li><div class="bh-sl-noresults-title">'+this.settings.noResultsTitle+'</div><br><div class="bh-sl-noresults-desc">'+this.settings.noResultsDesc+"</li>").hide().fadeIn(),t.append(e),e=g&&h?new google.maps.LatLng(g,h):new google.maps.LatLng(0,0),this.map.setCenter(e),j&&this.map.setZoom(j)},originMarker:function(t,e,s){var i;this.writeDebug("originMarker",arguments),!0===this.settings.originMarker&&(i="",void 0!==e&&(i=null!==this.settings.originMarkerImg?null===this.settings.originMarkerDim?this.markerImage(this.settings.originMarkerImg):this.markerImage(this.settings.originMarkerImg,this.settings.originMarkerDim.width,this.settings.originMarkerDim.height):{url:"https://mt.googleapis.com/vt/icon/name=icons/spotlight/spotlight-waypoint-a.png"},new google.maps.Marker({position:s,map:t,icon:i,draggable:!1})))},modalWindow:function(){var e;this.writeDebug("modalWindow"),!0===this.settings.modal&&((e=this).settings.callbackModalOpen&&e.settings.callbackModalOpen.call(this),A("."+e.settings.overlay).fadeIn(),A(G).on("click."+$,"."+e.settings.closeIcon+", ."+e.settings.overlay,function(){e.modalClose()}),A(G).on("click."+$,"."+e.settings.modalWindow,function(t){t.stopPropagation()}),A(G).on("keyup."+$,function(t){27===t.keyCode&&e.modalClose()}))},openNearestLocation:function(t,e,s,i){var n;this.writeDebug("openNearestLocation",arguments),!0!==this.settings.openNearest||void 0===t||!0===this.settings.fullMapStart&&!0===U||!0===this.settings.defaultLoc&&!0===U||((n=this).settings.callbackNearestLoc&&n.settings.callbackNearestLoc.call(this,n.map,t,e,s,i),t=J[0],n.createInfowindow(t,"left",e,s,i),s=A("."+n.settings.locationList),i=A("."+n.settings.locationList+" li[data-markerid=0]"),A("."+n.settings.locationList+" li").removeClass("list-focus"),i.addClass("list-focus"),s.animate({scrollTop:i.offset().top-s.offset().top+s.scrollTop()}))},listClick:function(s,i,n,a){this.writeDebug("listClick",arguments);var o=this;A(G).on("click."+$,"."+o.settings.locationList+" li",function(){var t=A(this).data("markerid"),e=J[t];o.settings.callbackListClick&&o.settings.callbackListClick.call(this,t,e,K[t],s),s.panTo(e.getPosition());!0===o.settings.bounceMarker?(e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null),o.createInfowindow(e,"left",i,n,a)},700)):o.createInfowindow(e,"left",i,n,a),null!==o.settings.selectedMarkerImg&&o.changeSelectedMarker(e),A("."+o.settings.locationList+" li").removeClass("list-focus"),A("."+o.settings.locationList+" li[data-markerid="+t+"]").addClass("list-focus")}),A(G).on("click."+$,"."+o.settings.locationList+" li a",function(t){t.stopPropagation()})},resultsTotalCount:function(t){this.writeDebug("resultsTotalCount",arguments);var e=A(".bh-sl-total-results");void 0===t||t<=0||0===e.length||e.text(t)},inlineDirections:function(e,s){var i;this.writeDebug("inlineDirections",arguments),!0===this.settings.inlineDirections&&void 0!==s&&(i=this,A(G).on("click."+$,"."+i.settings.locationList+" li .loc-directions a",function(t){t.preventDefault();t=A(this).closest("li").attr("data-markerid");i.directionsRequest(s,parseInt(t),e),A(G).on("click."+$,"."+i.settings.locationList+" .bh-sl-close-icon",function(){i.closeDirections()})}))},visibleMarkersList:function(t,e){var s;this.writeDebug("visibleMarkersList",arguments),!0===this.settings.visibleMarkersList&&(s=this,google.maps.event.addListenerOnce(t,"idle",function(){s.checkVisibleMarkers(e,t)}),google.maps.event.addListener(t,"center_changed",function(){s.checkVisibleMarkers(e,t)}),google.maps.event.addListener(t,"zoom_changed",function(){s.checkVisibleMarkers(e,t)}))},featuredDistanceRestriction:function(){this.writeDebug("featuredDistanceRestriction",arguments);var e=this;return H=A.grep(H,function(t){if(t.hasOwnProperty("distance"))return parseFloat(t.distance)<=parseFloat(e.settings.featuredDistance)})},featuredRestrictions:function(t){return this.writeDebug("featuredRestrictions",arguments),null===this.settings.featuredDistance||null!==this.settings.featuredDistance&&(H=this.featuredDistanceRestriction(t)),H},mapping:function(e){this.writeDebug("mapping",arguments);var t,s,i,n,a,o,r=this;this.isEmptyObject(e)||(t=e.lat,s=e.lng,i=e.geocodeResult,n=e.origin,o=e.page),!0===r.settings.pagination&&(void 0!==o&&_===l||(o=0)),z=void 0===n&&!0===this.settings.nameSearch?r._getData():(a=new google.maps.LatLng(t,s),void 0!==_&&n===_&&void 0!==N?(n=_,N):r._getData(g,h,n,i,e)),null!==r.settings.taxonomyFilters&&r.hasEmptyObjectVals(Z)&&r.checkFilters(),null!==r.settings.dataRaw?r.processData(e,a,z,o):z.done(function(t){r.processData(e,a,t,o)})},processData:function(t,e,s,i){this.writeDebug("processData",arguments);var n,a,o,r,l,g,c,h,u,d,p,m=this,f=0,b={},y=A("#"+m.settings.lengthSwapID);this.isEmptyObject(t)||(n=t.lat,a=t.lng,o=t.origin,t.name,r=t.distance);var k,v=A("#"+m.settings.mapID),D="km"===m.settings.lengthUnit?m.settings.kilometersLang:m.settings.milesLang;if(N=z,void 0!==o&&(_=o),m.settings.callbackSuccess&&m.settings.callbackSuccess.call(this,t,e,s,i),u=v.hasClass("bh-sl-map-open"),!0===m.settings.fullMapStart&&!1===u||!0===m.settings.autoGeocode&&!1===u||!0===m.settings.defaultLoc&&!1===u||!0===V?U=!0:m.reset(),v.addClass("bh-sl-map-open"),"json"===m.settings.dataType||"jsonp"===m.settings.dataType)for(var w=0;f<s.length;w++){var L,S=s[w],C={};for(L in S)S.hasOwnProperty(L)&&(C[L]=S[L]);m.locationsSetup(C,n,a,o,r),f++}else"kml"===m.settings.dataType?A(s).find("Placemark").each(function(){var t={name:A(this).find("name").text(),lat:A(this).find("coordinates").text().split(",")[1],lng:A(this).find("coordinates").text().split(",")[0],description:A(this).find("description").text()};m.locationsSetup(t,n,a,o,r),f++}):A(s).find(m.settings.xmlElement).each(function(){var t,e={};for(t in this.attributes)this.attributes.hasOwnProperty(t)&&(e[this.attributes[t].name]=this.attributes[t].value);m.locationsSetup(e,n,a,o,r),f++});if(!0===m.settings.nameSearch&&void 0!==Q&&""!==Q&&(Z[m.settings.nameAttribute]=[Q]),null!==m.settings.taxonomyFilters||!0===m.settings.nameSearch){for(var M in Z)if(Z.hasOwnProperty(M)&&0<Z[M].length)for(var I=0;I<Z[M].length;I++)b[M]||(b[M]=[]),M===m.settings.nameAttribute?b[M][I]="(?:^|\\s)"+Z[M][I].replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,""):b[M][I]="(?=.*"+Z[M][I].replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,"")+"(?!\\s))";m.isEmptyObject(b)||(K=A.grep(K,function(t){return m.filterData(t,b)}))}if(null!==m.settings.sortBy&&"object"==typeof m.settings.sortBy)m.sortCustom(K);else{if(void 0!==o&&m.sortNumerically(K),m.isEmptyObject(b))if(!0===m.settings.maxDistance&&r)(void 0===K[0]||K[0].distance>r)&&m.notify(m.settings.distanceErrorAlert+r+" "+D);else{if(void 0===K[0])throw new Error("No locations found. Please check the dataLocation setting and path.");-1!==m.settings.distanceAlert&&K[0].distance>m.settings.distanceAlert&&(m.notify(m.settings.distanceErrorAlert+m.settings.distanceAlert+" "+D),h=!0)}void 0!==K[0]&&(p=K[0])}if(!0===m.settings.featuredLocations&&(H=A.grep(K,function(t){if(t.hasOwnProperty("featured"))return"true"===t.featured}),H=m.featuredRestrictions(t),W=A.grep(K,function(t){if(t.hasOwnProperty("featured"))return"true"!==t.featured}),K=[],K=H.concat(W)),!0===m.settings.slideMap&&E.slideDown(),!0===m.settings.pagination&&m.paginationSetup(i),!0===m.settings.altDistanceNoResult&&p.distance>m.settings.distanceAlert)m.emptyResult();else if(m.isEmptyObject(K)||"none"===K[0].result)m.emptyResult();else{m.modalWindow(),q=-1===m.settings.storeLimit||K.length<m.settings.storeLimit||!0===this.settings.fullMapStart&&!0===U&&(!isNaN(this.settings.fullMapStartListLimit)||26<this.settings.fullMapStartListLimit||-1===this.settings.fullMapStartListLimit)?K.length:m.settings.storeLimit,!0===m.settings.pagination?(c=m.settings.locationsPerPage,(g=i*m.settings.locationsPerPage)+c>K.length&&(c=m.settings.locationsPerPage-(g+c-K.length)),K=K.slice(g,g+c),q=K.length):(c=q,g=0),m.resultsTotalCount(K.length),!0===m.settings.fullMapStart&&!0===U&&!0!==m.settings.querystringParams||0===m.settings.mapSettings.zoom||void 0===o||!0===h||!0===m.settings.maxDistance&&!1===U?(k=m.settings.mapSettings,l=new google.maps.LatLngBounds):k=(!0===m.settings.pagination?(D=new google.maps.LatLng(K[0].lat,K[0].lng),m.settings.mapSettings.center=0===i?e:D):m.settings.mapSettings.center=e,m.settings.mapSettings),m.map=new google.maps.Map(G.getElementById(m.settings.mapID),k),google.maps.event.addDomListener(B,"resize",function(){var t=m.map.getCenter();google.maps.event.trigger(m.map,"resize"),m.map.setCenter(t)}),!0===m.settings.dragSearch&&m.map.addListener("dragend",function(){m.dragSearch(m.map)}),E.data(m.settings.mapID.replace("#",""),m.map),m.settings.callbackMapSet&&m.settings.callbackMapSet.call(this,m.map,e,j,k),d="undefined"!=typeof InfoBubble&&null!==m.settings.infoBubble?((k=m.settings.infoBubble).map=m.map,new InfoBubble(k)):new google.maps.InfoWindow,m.originMarker(m.map,o,e),A(G).on("click."+$,".bh-sl-pagination li",function(t){t.preventDefault(),m.paginationChange(A(this).attr("data-page"))}),m.inlineDirections(m.map,o);for(var x,F=0;F<=c-1;F++){var P="",P=0<i?String.fromCharCode("A".charCodeAt(0)+(g+F)):String.fromCharCode("A".charCodeAt(0)+F),R=new google.maps.LatLng(K[F].lat,K[F].lng);(P=m.createMarker(R,K[F].name,K[F].address,P,m.map,K[F].category)).set("id",F),J[F]=P,(!0===m.settings.fullMapStart&&!0===U&&!0!==m.settings.querystringParams||0===m.settings.mapSettings.zoom||void 0===o||!0===h||!0===m.settings.maxDistance&&!1===U)&&l.extend(R),m.createInfowindow(P,null,d,g,i)}if((!0===m.settings.fullMapStart&&!0===U&&!0!==m.settings.querystringParams||0===m.settings.mapSettings.zoom||void 0===o||!0===h||!0===m.settings.maxDistance&&!1===U)&&(m.map.fitBounds(l),x=google.maps.event.addListener(m.map,"idle",function(){16<m.map.getZoom()&&m.map.setZoom(16),google.maps.event.removeListener(x)})),A("."+m.settings.locationList+" ul").empty(),U&&!1!==m.settings.fullMapStartListLimit&&!isNaN(m.settings.fullMapStartListLimit)&&-1!==m.settings.fullMapStartListLimit&&J.length>m.settings.fullMapStartListLimit)for(var O=0;O<m.settings.fullMapStartListLimit;O++){var T=J[O];m.listSetup(T,g,i)}else A(J).each(function(t){t=J[t];m.listSetup(t,g,i)});y.length&&(m.lengthUnitSwap(y),y.on("change."+$,function(t){t.stopPropagation(),m.lengthUnitSwap(y)})),m.openNearestLocation(p,d,g,i),"undefined"!=typeof MarkerClusterer&&null!==m.settings.markerCluster&&new MarkerClusterer(m.map,J,m.settings.markerCluster),m.listClick(m.map,d,g,i),A("."+m.settings.locationList+" ul > li:even").css("background",m.settings.listColor1),A("."+m.settings.locationList+" ul > li:odd").css("background",m.settings.listColor2),m.visibleMarkersList(m.map,J),!0===m.settings.modal&&m.settings.callbackModalReady&&m.settings.callbackModalReady.call(this,t),m.settings.callbackFilters&&m.settings.callbackFilters.call(this,Z,t)}},writeDebug:function(){B.console&&this.settings.debug&&(Function.prototype.bind?this.writeDebug=Function.prototype.bind.call(console.log,console,"StoreLocator :"):this.writeDebug=function(){arguments[0]="StoreLocator : "+arguments[0],Function.prototype.apply.call(console.log,console,arguments)},this.writeDebug.apply(this,arguments))}}),A.fn[$]=function(e){var s,i=arguments;return e===t||"object"==typeof e?this.each(function(){A.data(this,"plugin_"+$)||A.data(this,"plugin_"+$,new f(this,e))}):"string"==typeof e&&"_"!==e[0]&&"init"!==e?(this.each(function(){var t=A.data(this,"plugin_"+$);t instanceof f&&"function"==typeof t[e]&&(s=t[e].apply(t,Array.prototype.slice.call(i,1))),"destroy"===e&&A.data(this,"plugin_"+$,null)}),s!==t?s:this):void 0})}(jQuery,window,document);