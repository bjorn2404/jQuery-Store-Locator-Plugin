/*! jQuery Google Maps Store Locator - v3.3.0 - 2023-12-10
* http://www.bjornblog.com/web/jquery-store-locator-plugin
* Copyright (c) 2023 Bjorn Holine; Licensed MIT */

!function(E,N,j,t){"use strict";var _,a,r,c,z,Q,V,q,U,K,l,g,H,i,n,f,s,W,J,$,o,Z,X,Y,tt,et,h,u,st,d,p,it="storeLocator",b=!1,e=null;function m(t,s){var i,e;_=E(t),this.element=t,this.settings=E.extend({},p,s),this._defaults=p,this._name=it,this.settings.lazyLoadMap&&null!==this.settings.apiKey&&"undefined"==typeof google?(!!(e={})===(i=this).settings.autoComplete&&(e.libraries="places"),this.settings.callbackBeforeMapInject?new Promise(function(t,e){i.settings.callbackBeforeMapInject.call(this,s,t)}).then(function(){i.triggerMapLoad(e)}):i.triggerMapLoad(e)):this.init()}void 0===E.fn[it]&&(p={ajaxData:null,altDistanceNoResult:!(d={}),apiKey:null,autoComplete:!(st={}),autoCompleteDisableListener:!(u={}),autoCompleteOptions:{},autoGeocode:!(h={}),bounceMarker:!0,catMarkers:null,dataLocation:"data/locations.json",dataRaw:null,dataType:"json",debug:!(et={}),defaultLat:null,defaultLng:null,defaultLoc:!(tt=[]),disableAlphaMarkers:!(Y=[]),distanceAlert:60,dragSearch:!(X=[]),exclusiveFiltering:!(Z=[]),exclusiveTax:null,featuredDistance:null,featuredLocations:!1,fullMapStart:!1,fullMapStartBlank:!1,fullMapStartListLimit:!1,infoBubble:null,inlineDirections:!1,lazyLoadMap:!1,lengthUnit:"m",listColor1:"#ffffff",listColor2:"#eeeeee",loading:!1,locationsPerPage:10,mapSettings:{mapTypeId:"roadmap",zoom:12},markerCluster:null,markerImg:null,markerDim:null,maxDistance:!1,modal:!1,nameAttribute:"name",nameSearch:!1,noForm:!1,openNearest:!1,originMarker:!1,originMarkerDim:null,originMarkerImg:null,pagination:!1,querystringParams:!1,selectedMarkerImg:null,selectedMarkerImgDim:null,sessionStorage:!1,slideMap:!0,sortBy:null,storeLimit:26,taxonomyFilters:null,visibleMarkersList:!1,xmlElement:"marker",addressID:"bh-sl-address",closeIcon:"bh-sl-close-icon",formContainer:"bh-sl-form-container",formID:"bh-sl-user-location",geocodeID:null,lengthSwapID:"bh-sl-length-swap",loadingContainer:"bh-sl-loading",locationList:"bh-sl-loc-list",mapID:"bh-sl-map",maxDistanceID:"bh-sl-maxdistance",modalContent:"bh-sl-modal-content",modalWindow:"bh-sl-modal-window",orderID:"bh-sl-order",overlay:"bh-sl-overlay",regionID:"bh-sl-region",searchID:"bh-sl-search",sortID:"bh-sl-sort",taxonomyFiltersContainer:"bh-sl-filters-container",infowindowTemplatePath:"assets/js/plugins/storeLocator/templates/infowindow-description.html",listTemplatePath:"assets/js/plugins/storeLocator/templates/location-list-description.html",KMLinfowindowTemplatePath:"assets/js/plugins/storeLocator/templates/kml-infowindow-description.html",KMLlistTemplatePath:"assets/js/plugins/storeLocator/templates/kml-location-list-description.html",listTemplateID:null,infowindowTemplateID:null,callbackAutoGeoSuccess:null,callbackBeforeMapInject:null,callbackBeforeSend:null,callbackCloseDirections:null,callbackCreateMarker:null,callbackDirectionsRequest:null,callbackFilters:null,callbackFormVals:null,callbackGeocodeRestrictions:null,callbackJsonp:null,callbackListClick:null,callbackMapSet:null,callbackMarkerClick:null,callbackModalClose:null,callbackModalOpen:null,callbackModalReady:null,callbackNearestLoc:null,callbackNoResults:null,callbackNotify:null,callbackOrder:null,callbackPageChange:null,callbackRegion:null,callbackSorting:null,callbackSuccess:null,addressErrorAlert:"Unable to find address",autoGeocodeErrorAlert:"Automatic location detection failed. Please fill in your address or zip code.",distanceErrorAlert:"Unfortunately, our closest location is more than ",kilometerLang:"kilometer",kilometersLang:"kilometers",mileLang:"mile",milesLang:"miles",noResultsTitle:"No results",noResultsDesc:"No locations were found with the given criteria. Please modify your selections or input.",nextPage:"Next &raquo;",prevPage:"&laquo; Prev"},E.extend(m.prototype,{init:function(){var t,e=this;this.writeDebug("init"),"km"===this.settings.lengthUnit?u.EarthRadius=6367:u.EarthRadius=3956,c="kml"===this.settings.dataType?"xml":this.settings.dataType,!0===this.settings.inlineDirections&&E("."+this.settings.locationList).prepend('<div class="bh-sl-directions-panel"></div>'),V=this.settings.mapSettings.zoom,Handlebars.registerHelper("niceURL",function(t){if(t)return t.replace("https://","").replace("http://","")}),!0===this.settings.maxDistance&&this.distanceFiltering(),null!==this.settings.taxonomyFilters&&this.taxonomyFiltering(),this.sorting(),this.order(),!0===this.settings.modal&&(null!==this.settings.taxonomyFilters&&E("."+this.settings.taxonomyFiltersContainer).clone(!0,!0).prependTo(_),_.wrap('<div class="'+this.settings.overlay+'"><div class="'+this.settings.modalWindow+'"><div class="'+this.settings.modalContent+'">'),E("."+this.settings.modalWindow).prepend('<div class="'+this.settings.closeIcon+'"></div>'),E("."+this.settings.overlay).hide()),!0===this.settings.autoComplete&&(t=j.getElementById(this.settings.addressID),t=new google.maps.places.Autocomplete(t,this.settings.autoCompleteOptions),!0===this.settings.autoComplete)&&!0!==this.settings.autoCompleteDisableListener&&t.addListener("place_changed",function(t){e.processForm(t)}),this._loadTemplates()},triggerMapLoad:function(t){this.writeDebug("triggerMapLoad");var e=this;this.loadMapsAPI(this.settings.apiKey,t).then(function(t){e.map=t,e.init()})},injectGoogleMapsScript:function(e){if(this.writeDebug("injectGoogleMapsScript"),e=void 0!==e?e:{},b)throw new Error("Google Maps API is already loaded.");var t="https://maps.googleapis.com/maps/api/js?"+Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t])).join("&"),s=j.createElement("script");s.setAttribute("src",t),s.setAttribute("async",""),s.setAttribute("defer",""),j.head.appendChild(s),b=!0},loadMapsAPI:function(s,i){this.writeDebug("loadMapsAPI"),i=void 0!==i?i:{};var n=this;return e=e||new Promise(function(t,e){try{N.onGoogleMapsAPILoaded=t,n.injectGoogleMapsScript({key:s,callback:"onGoogleMapsAPILoaded",...i})}catch(t){e(t)}}).then(function(){N.google.maps})},destroy:function(){this.writeDebug("destroy"),this.reset();var t=E("#"+this.settings.mapID);if(tt.length)for(var e=0;e<=tt.length;e++)google.maps.event.removeListener(tt[e]);E("."+this.settings.locationList+" ul").empty(),t.hasClass("bh-sl-map-open")&&t.empty().removeClass("bh-sl-map-open"),!0===this.settings.modal&&E(". "+this.settings.overlay).remove(),t.attr("style",""),_.hide(),E.removeData(_.get(0)),E(j).off(it),_.unbind()},reset:function(){var t;this.writeDebug("reset"),X=[],Z=[],Y=[],W=!(tt=[]),E(j).off("click."+it,"."+this.settings.locationList+" li"),E("."+this.settings.locationList+" .bh-sl-close-directions-container").length&&E(".bh-sl-close-directions-container").remove(),!0===this.settings.inlineDirections&&(0<(t=E("."+this.settings.locationList+" .adp")).length&&(t.remove(),E("."+this.settings.locationList+" ul").fadeIn()),E(j).off("click","."+this.settings.locationList+" li .loc-directions a")),!0===this.settings.pagination&&E(j).off("click."+it,".bh-sl-pagination li")},formFiltersReset:function(){var t,e;this.writeDebug("formFiltersReset"),null!==this.settings.taxonomyFilters&&(t=E("."+this.settings.taxonomyFiltersContainer+" input"),e=E("."+this.settings.taxonomyFiltersContainer+" select"),"object"==typeof t)&&(t.each(function(){(E(this).is('input[type="checkbox"]')||E(this).is('input[type="radio"]'))&&E(this).prop("checked",!1)}),e.each(function(){E(this).prop("selectedIndex",0)}))},mapReload:function(){this.writeDebug("mapReload"),this.reset(),J=!0,null!==this.settings.taxonomyFilters&&(this.formFiltersReset(),this.resetDisabledFilterVals(),this.taxonomyFiltersInit()),l&&g?(this.settings.mapSettings.zoom=V,this.processForm()):this.mapping(st)},notify:function(t){this.writeDebug("notify",t),this.settings.callbackNotify?this.settings.callbackNotify.call(this,t):alert(t)},geoCodeCalcToRadian:function(t){return this.writeDebug("geoCodeCalcToRadian",t),t*(Math.PI/180)},geoCodeCalcDiffRadian:function(t,e){return this.writeDebug("geoCodeCalcDiffRadian",arguments),this.geoCodeCalcToRadian(e)-this.geoCodeCalcToRadian(t)},geoCodeCalcCalcDistance:function(t,e,s,i,n){return this.writeDebug("geoCodeCalcCalcDistance",arguments),2*n*Math.asin(Math.min(1,Math.sqrt(Math.pow(Math.sin(this.geoCodeCalcDiffRadian(t,s)/2),2)+Math.cos(this.geoCodeCalcToRadian(t))*Math.cos(this.geoCodeCalcToRadian(s))*Math.pow(Math.sin(this.geoCodeCalcDiffRadian(e,i)/2),2))))},inRange:function(t,e,s){return this.writeDebug("inRange",arguments),e=Math.abs(e),isFinite(e)&&t<=e&&e<=s},coordinatesInRange:function(t,e){return this.writeDebug("coordinatesInRange",arguments),this.inRange(-90,t,90)&&this.inRange(-180,e,180)},getQueryString:function(t){if(this.writeDebug("getQueryString",t),t)return t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null===(t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search))?"":decodeURIComponent(t[1].replace(/\+/g," "))},getMap:function(){return this.map},_loadTemplates:function(){this.writeDebug("_loadTemplates");var e,t=this,s='<div class="bh-sl-error">Error: Could not load plugin templates. Check the paths and ensure they have been uploaded. Paths will be wrong if you do not run this from a web server.</div>';"kml"===this.settings.dataType&&null===this.settings.listTemplateID&&null===this.settings.infowindowTemplateID?E.when(E.get(this.settings.KMLinfowindowTemplatePath,function(t){e=t,r=Handlebars.compile(e)}),E.get(this.settings.KMLlistTemplatePath,function(t){e=t,a=Handlebars.compile(e)})).then(function(){t.locator()},function(){throw E("."+t.settings.formContainer).append(s),new Error("Could not load storeLocator plugin templates")}):null!==this.settings.listTemplateID&&null!==this.settings.infowindowTemplateID?(r=Handlebars.compile(E("#"+this.settings.infowindowTemplateID).html()),a=Handlebars.compile(E("#"+this.settings.listTemplateID).html()),t.locator()):E.when(E.get(this.settings.infowindowTemplatePath,function(t){e=t,r=Handlebars.compile(e)}),E.get(this.settings.listTemplatePath,function(t){e=t,a=Handlebars.compile(e)})).then(function(){t.locator()},function(){throw E("."+t.settings.formContainer).append(s),new Error("Could not load storeLocator plugin templates")})},locator:function(){this.writeDebug("locator"),!0===this.settings.slideMap&&_.hide(),this._start(),this._formEventHandler()},_formEventHandler:function(){this.writeDebug("_formEventHandler");var e=this;!0===this.settings.noForm?(E(j).on("click."+it,"."+this.settings.formContainer+" button",function(t){e.processForm(t)}),E(j).on("keydown."+it,function(t){13===t.keyCode&&E("#"+e.settings.addressID).is(":focus")&&e.processForm(t)})):E(j).on("submit."+it,"#"+this.settings.formID,function(t){e.processForm(t)}),E(".bh-sl-reset").length&&E("#"+this.settings.mapID).length&&E(j).on("click."+it,".bh-sl-reset",function(){e.mapReload()}),E("#"+this.settings.addressID).on("change."+it,function(){o=t,d={},""!==E.trim(E("#"+e.settings.addressID).val())||void 0!==U&&""!==U||null!==e.settings.taxonomyFilters&&!1===e.settings.exclusiveFiltering&&(z=g=l=t,st={},e.resetDisabledFilterVals(),e.taxonomyFiltersInit(),e.mapping(null))})},_getData:function(t,e,s,i,n){this.writeDebug("_getData",arguments);var a,o=this,r="",l="",g="";return void 0!==i&&void 0!==i.geometry.bounds&&(g=i.formatted_address,r=JSON.stringify(i.geometry.bounds.getNorthEast()),l=JSON.stringify(i.geometry.bounds.getSouthWest())),this.settings.callbackBeforeSend&&this.settings.callbackBeforeSend.call(this,t,e,s,g,r,l,n),null!==o.settings.dataRaw?"xml"===c?E.parseXML(o.settings.dataRaw):"json"===c?Array.isArray&&Array.isArray(o.settings.dataRaw)?o.settings.dataRaw:"string"==typeof o.settings.dataRaw?JSON.parse(o.settings.dataRaw):[]:void 0:(a=E.Deferred(),!0===this.settings.loading&&E("."+this.settings.formContainer).append('<div class="'+this.settings.loadingContainer+'"></div>'),i={origLat:t,origLng:e,origAddress:s,formattedAddress:g,boundsNorthEast:r,boundsSouthWest:l},null!==this.settings.ajaxData&&"object"==typeof this.settings.ajaxData&&E.extend(i,this.settings.ajaxData),E.ajax({type:"GET",url:this.settings.dataLocation+("jsonp"===this.settings.dataType?(this.settings.dataLocation.match(/\?/)?"&":"?")+"callback=?":""),data:i,dataType:c,jsonpCallback:"jsonp"===this.settings.dataType?this.settings.callbackJsonp:null}).done(function(t){a.resolve(t),!0===o.settings.loading&&E("."+o.settings.formContainer+" ."+o.settings.loadingContainer).remove()}).fail(a.reject),a.promise())},_start:function(){this.writeDebug("_start");var t,e,s=this,i=this.settings.autoGeocode;!1!==s.settings.fullMapStartBlank?(E("#"+s.settings.mapID).addClass("bh-sl-map-open"),(e=s.settings.mapSettings).zoom=s.settings.fullMapStartBlank,t=new google.maps.LatLng(this.settings.defaultLat,this.settings.defaultLng),e.center=t,s.map=new google.maps.Map(j.getElementById(s.settings.mapID),e),N.addEventListener("resize",function(){var t=s.map.getCenter();google.maps.event.trigger(s.map,"resize"),s.map.setCenter(t)}),s.settings.fullMapStartBlank=!1,e.zoom=V):(!0===this.settings.defaultLoc&&this.defaultLocation(),""!==E.trim(E("#"+this.settings.addressID).val())?(s.writeDebug("Using Address Field"),s.processForm(null),i=!1):!0===this.settings.fullMapStart&&!1===this.settings.defaultLoc&&(!0===this.settings.querystringParams&&this.getQueryString(this.settings.addressID)||!0===this.settings.querystringParams&&this.getQueryString(this.settings.searchID)||!0===this.settings.querystringParams&&this.getQueryString(this.settings.maxDistanceID)?(s.writeDebug("Using Query String"),this.processForm(null),i=!1):this.mapping(null))),!0===this.settings.autoGeocode&&!0===i&&(s.writeDebug("Auto Geo"),s.htmlGeocode()),null!==this.settings.autoGeocode&&(s.writeDebug("Button Geo"),E(j).on("click."+it,"#"+this.settings.geocodeID,function(){s.htmlGeocode()}))},htmlGeocode:function(){this.writeDebug("htmlGeocode",arguments);var e=this;if(!0===e.settings.sessionStorage&&N.sessionStorage&&N.sessionStorage.getItem("myGeo"))return e.writeDebug("Using Session Saved Values for GEO"),e.autoGeocodeQuery(JSON.parse(N.sessionStorage.getItem("myGeo"))),!1;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){e.writeDebug("Current Position Result");t={coords:{latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy}};!0===e.settings.sessionStorage&&N.sessionStorage&&N.sessionStorage.setItem("myGeo",JSON.stringify(t)),e.settings.callbackAutoGeoSuccess&&e.settings.callbackAutoGeoSuccess.call(this,t),e.autoGeocodeQuery(t)},function(t){e._autoGeocodeError(t)})},googleGeocode:function(t){t.writeDebug("googleGeocode",arguments);var e=new google.maps.Geocoder;this.geocode=function(t,s){e.geocode(t,function(t,e){if(e!==google.maps.GeocoderStatus.OK)throw s(null),new Error("Geocode was not successful for the following reason: "+e);e={};e.latitude=t[0].geometry.location.lat(),e.longitude=t[0].geometry.location.lng(),e.geocodeResult=t[0],s(e)})}},reverseGoogleGeocode:function(t){t.writeDebug("reverseGoogleGeocode",arguments);var e=new google.maps.Geocoder;this.geocode=function(t,s){e.geocode(t,function(t,e){if(e!==google.maps.GeocoderStatus.OK)throw s(null),new Error("Reverse geocode was not successful for the following reason: "+e);t[0]&&((e={}).address=t[0].formatted_address,e.fullResult=t[0],s(e))})}},roundNumber:function(t,e){return this.writeDebug("roundNumber",arguments),Math.round(t*Math.pow(10,e))/Math.pow(10,e)},isEmptyObject:function(t){for(var e in this.writeDebug("isEmptyObject",arguments),t)if(t.hasOwnProperty(e))return!1;return!0},hasEmptyObjectVals:function(t){this.writeDebug("hasEmptyObjectVals",arguments);var e,s=!0;for(e in t)t.hasOwnProperty(e)&&""!==t[e]&&0!==t[e].length&&(s=!1);return s},hasSingleGroupFilterVal:function(t,e){this.writeDebug("hasSingleGroupFilterVal",arguments);t=Object.assign({},t);return!this.hasEmptyObjectVals(t[e])},modalClose:function(){this.writeDebug("modalClose"),this.settings.callbackModalClose&&this.settings.callbackModalClose.call(this),et={},E("."+this.settings.overlay+" select").prop("selectedIndex",0),E("."+this.settings.overlay+" input").prop("checked",!1),E("."+this.settings.overlay).hide()},_createLocationVariables:function(t){var e,s;for(s in this.writeDebug("_createLocationVariables",arguments),h={},X[t])X[t].hasOwnProperty(s)&&(e=X[t][s],"distance"!==s&&"altdistance"!==s||(e=this.roundNumber(e,2)),h[s]=e)},sortAlpha:function(t){this.writeDebug("sortAlpha",arguments);var s=this.settings.sortBy.hasOwnProperty("prop")&&void 0!==this.settings.sortBy.prop?this.settings.sortBy.prop:"name";this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?t.sort(function(t,e){return e[s].toLowerCase().localeCompare(t[s].toLowerCase())}):t.sort(function(t,e){return t[s].toLowerCase().localeCompare(e[s].toLowerCase())})},sortDate:function(t){this.writeDebug("sortDate",arguments);var s=this.settings.sortBy.hasOwnProperty("prop")&&void 0!==this.settings.sortBy.prop?this.settings.sortBy.prop:"date";this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?t.sort(function(t,e){return new Date(e[s]).getTime()-new Date(t[s]).getTime()}):t.sort(function(t,e){return new Date(t[s]).getTime()-new Date(e[s]).getTime()})},sortNumerically:function(t,e){this.writeDebug("sortNumerically",arguments);var s=null!==this.settings.sortBy&&this.settings.sortBy.hasOwnProperty("prop")&&void 0!==this.settings.sortBy.prop?this.settings.sortBy.prop:"distance";void 0!==e&&!0===e&&(s="distance"),null!==this.settings.sortBy&&this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?t.sort(function(t,e){return e[s]<t[s]?-1:e[s]>t[s]?1:0}):t.sort(function(t,e){return t[s]<e[s]?-1:t[s]>e[s]?1:0})},sortCustom:function(t){this.writeDebug("sortCustom",arguments),this.settings.sortBy.hasOwnProperty("method")&&"alpha"===this.settings.sortBy.method.toString()?this.sortAlpha(t):this.settings.sortBy.hasOwnProperty("method")&&"date"===this.settings.sortBy.method.toString()?this.sortDate(t):this.sortNumerically(t)},filterMatching:function(t,e,s){return this.writeDebug("inclusiveFilter",arguments),void 0!==e&&(s=!0===(s=void 0===s||s)?t.join(""):t.join("|"),!!new RegExp(s,"i").test(e.replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,"")))},filterData:function(t,e){this.writeDebug("filterData",arguments);var s,i=!0;for(s in e)if(e.hasOwnProperty(s)){for(var n=[],a=0;a<e[s].length;a++)!0===this.settings.exclusiveFiltering||null!==this.settings.exclusiveTax&&Array.isArray(this.settings.exclusiveTax)&&-1!==this.settings.exclusiveTax.indexOf(s)?n[a]=this.filterMatching(e[s],t[s],!1):n[a]=this.filterMatching(e[s],t[s]);if(void 0!==$&&-1!==$.indexOf(s)&&-1!==n.indexOf(!0))return!0;-1===n.indexOf(!0)&&(i=!1)}return i},_paginationOutput:function(t,e){this.writeDebug("_paginationOutput",arguments);var s="",i=(t=parseFloat(t))+1;0<t&&(s+='<li class="bh-sl-next-prev" data-page="'+(t-1)+'">'+this.settings.prevPage+"</li>");for(var n=0;n<Math.ceil(e);n++){var a=n+1;s+=n===t?'<li class="bh-sl-current" data-page="'+n+'">'+a+"</li>":'<li data-page="'+n+'">'+a+"</li>"}return i<e&&(s+='<li class="bh-sl-next-prev" data-page="'+i+'">'+this.settings.nextPage+"</li>"),s},paginationSetup:function(t){this.writeDebug("paginationSetup",arguments);var e="",s=E(".bh-sl-pagination-container .bh-sl-pagination"),i=-1===this.settings.storeLimit||X.length<this.settings.storeLimit?X.length/this.settings.locationsPerPage:this.settings.storeLimit/this.settings.locationsPerPage;void 0===t&&(t=0),e=(0===s.length||s.empty(),this._paginationOutput(t,i)),s.append(e)},markerImage:function(t,e,s){return this.writeDebug("markerImage",arguments),void 0!==e&&void 0!==s?{url:t,size:new google.maps.Size(e,s),scaledSize:new google.maps.Size(e,s)}:{url:t,size:new google.maps.Size(32,32),scaledSize:new google.maps.Size(32,32)}},createMarker:function(t,e,s,i,n,a){var o;this.writeDebug("createMarker",arguments);if(null!==this.settings.catMarkers&&void 0!==a)if(-1!==a.indexOf(","))for(var r=a.split(","),l=0;l<r.length;l++)r[l]in this.settings.catMarkers&&(o=this.markerImage(this.settings.catMarkers[r[l]][0],parseInt(this.settings.catMarkers[r[l]][1]),parseInt(this.settings.catMarkers[r[l]][2])));else a in this.settings.catMarkers&&(o=this.markerImage(this.settings.catMarkers[a][0],parseInt(this.settings.catMarkers[a][1]),parseInt(this.settings.catMarkers[a][2])));return null!==this.settings.markerImg&&(o=null===this.settings.markerDim?this.markerImage(this.settings.markerImg):this.markerImage(this.settings.markerImg,this.settings.markerDim.width,this.settings.markerDim.height)),this.settings.callbackCreateMarker?this.settings.callbackCreateMarker.call(this,n,t,i,a):!0===this.settings.disableAlphaMarkers||-1===this.settings.storeLimit||26<this.settings.storeLimit||null!==this.settings.catMarkers||null!==this.settings.markerImg||!0===this.settings.fullMapStart&&!0===W&&(isNaN(this.settings.fullMapStartListLimit)||26<this.settings.fullMapStartListLimit||-1===this.settings.fullMapStartListLimit)?new google.maps.Marker({draggable:!1,icon:o,map:n,optimized:!1,position:t,title:e}):new google.maps.Marker({draggable:!1,label:i,map:n,optimized:!1,position:t,title:e})},_defineLocationData:function(t,e,s){this.writeDebug("_defineLocationData",arguments);var i,n,a="",t=(this._createLocationVariables(t.get("id")),i=h.distance<=1?"km"===this.settings.lengthUnit?(n=this.settings.kilometerLang,this.settings.mileLang):(n=this.settings.mileLang,this.settings.kilometerLang):"km"===this.settings.lengthUnit?(n=this.settings.kilometersLang,this.settings.milesLang):(n=this.settings.milesLang,this.settings.kilometersLang),t.get("id")),a=!0===this.settings.disableAlphaMarkers||-1===this.settings.storeLimit||26<this.settings.storeLimit||!0===this.settings.fullMapStart&&!0===W&&(isNaN(this.settings.fullMapStartListLimit)||26<this.settings.fullMapStartListLimit||-1===this.settings.fullMapStartListLimit)?t+1:0<s?String.fromCharCode("A".charCodeAt(0)+(e+t)):String.fromCharCode("A".charCodeAt(0)+t);return{location:[E.extend(h,{markerid:t,marker:a,altlength:i,length:n,origin:z})]}},listSetup:function(t,e,s){this.writeDebug("listSetup",arguments);t=this._defineLocationData(t,e,s),e=a(t);E("."+this.settings.locationList+" > ul").append(e)},changeSelectedMarker:function(t){var e;void 0!==s&&s.setIcon(f),e=null===this.settings.selectedMarkerImgDim?this.markerImage(this.settings.selectedMarkerImg):this.markerImage(this.settings.selectedMarkerImg,this.settings.selectedMarkerImgDim.width,this.settings.selectedMarkerImgDim.height),f=t.icon,t.setIcon(e),s=t},createInfowindow:function(s,t,i,e,n){this.writeDebug("createInfowindow",arguments);var a=this,e=this._defineLocationData(s,e,n),o=r(e);"left"===t?(i.setContent(o),i.open(s.get("map"),s)):google.maps.event.addListener(s,"click",function(){i.setContent(o),i.open(s.get("map"),s);var t=s.get("id"),e=E("."+a.settings.locationList+" li[data-markerid="+t+"]");0<e.length&&(a.settings.callbackMarkerClick&&a.settings.callbackMarkerClick.call(this,s,t,e,X[t],a.map),E("."+a.settings.locationList+" li").removeClass("list-focus"),e.addClass("list-focus"),(t=E("."+a.settings.locationList)).animate({scrollTop:e.offset().top-t.offset().top+t.scrollTop()})),null!==a.settings.selectedMarkerImg&&a.changeSelectedMarker(s)})},autoGeocodeQuery:function(e){this.writeDebug("autoGeocodeQuery",arguments);var s,i=this,n=null,t=E("#"+this.settings.maxDistanceID),t=(!0===this.settings.querystringParams&&this.getQueryString(this.settings.maxDistanceID)?(n=this.getQueryString(this.settings.maxDistanceID),""!==t.val()&&(n=t.val())):!0===this.settings.maxDistance&&(n=t.val()||""),new this.reverseGoogleGeocode(this)),a=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);t.geocode({latLng:a},function(t){null!==t?(s=K=t.address,l=st.lat=e.coords.latitude,g=st.lng=e.coords.longitude,st.origin=s,st.distance=n,i.mapping(st),void 0!==s&&E("#"+i.settings.addressID).val(s)):i.notify(i.settings.addressErrorAlert)})},_autoGeocodeError:function(){this.writeDebug("_autoGeocodeError"),this.notify(this.settings.autoGeocodeErrorAlert)},defaultLocation:function(){this.writeDebug("defaultLocation");var e,s=this,i=null,t=E("#"+this.settings.maxDistanceID),t=(!0===this.settings.querystringParams&&this.getQueryString(this.settings.maxDistanceID)?(i=this.getQueryString(this.settings.maxDistanceID),""!==t.val()&&(i=t.val())):!0===this.settings.maxDistance&&(i=t.val()||""),new this.reverseGoogleGeocode(this)),n=new google.maps.LatLng(this.settings.defaultLat,this.settings.defaultLng);t.geocode({latLng:n},function(t){null!==t?(e=K=t.address,l=st.lat=s.settings.defaultLat,g=st.lng=s.settings.defaultLng,st.distance=i,st.origin=e,s.mapping(st)):s.notify(s.settings.addressErrorAlert)})},paginationChange:function(t){this.writeDebug("paginationChange",arguments),this.settings.callbackPageChange&&this.settings.callbackPageChange.call(this,t),st.page=t,this.mapping(st)},getAddressByMarker:function(t){this.writeDebug("getAddressByMarker",arguments);var e="";return X[t].address&&(e+=X[t].address+" "),X[t].address2&&(e+=X[t].address2+" "),X[t].city&&(e+=X[t].city+", "),X[t].state&&(e+=X[t].state+" "),X[t].postal&&(e+=X[t].postal+" "),X[t].country&&(e+=X[t].country+" "),e},clearMarkers:function(){this.writeDebug("clearMarkers");for(var t=null,t=X.length<this.settings.storeLimit?X.length:this.settings.storeLimit,e=0;e<t;e++)tt[e].setMap(null)},directionsRequest:function(t,e,s){this.writeDebug("directionsRequest",arguments),this.settings.callbackDirectionsRequest&&this.settings.callbackDirectionsRequest.call(this,t,e,s,X[e]);e=this.getAddressByMarker(e);e&&(E("."+this.settings.locationList+" ul").hide(),this.clearMarkers(),null!=i&&(i.setMap(null),i=null),i=new google.maps.DirectionsRenderer,n=new google.maps.DirectionsService,i.setMap(s),i.setPanel(E(".bh-sl-directions-panel").get(0)),s={origin:t,destination:e,travelMode:google.maps.TravelMode.DRIVING},n.route(s,function(t,e){e===google.maps.DirectionsStatus.OK&&i.setDirections(t)}),E("."+this.settings.locationList).prepend('<div class="bh-sl-close-directions-container"><div class="'+this.settings.closeIcon+'"></div></div>')),E(j).off("click","."+this.settings.locationList+" li .loc-directions a")},closeDirections:function(){this.writeDebug("closeDirections"),this.settings.callbackCloseDirections&&this.settings.callbackCloseDirections.call(this),this.reset(),l&&g&&(0===this.countFilters()?this.settings.mapSettings.zoom=V:this.settings.mapSettings.zoom=0,this.processForm(null)),E(j).off("click."+it,"."+this.settings.locationList+" .bh-sl-close-icon")},lengthUnitSwap:function(t){this.writeDebug("lengthUnitSwap",arguments),"alt-distance"===t.val()?(E("."+this.settings.locationList+" .loc-alt-dist").show(),E("."+this.settings.locationList+" .loc-default-dist").hide()):"default-distance"===t.val()&&(E("."+this.settings.locationList+" .loc-default-dist").show(),E("."+this.settings.locationList+" .loc-alt-dist").hide())},processForm:function(t){this.writeDebug("processForm",arguments);var e=this,s=null,i={},n=E("#"+this.settings.addressID),a=E("#"+this.settings.searchID),o=E("#"+this.settings.maxDistanceID),r="";null!=t&&t.preventDefault(),E("."+e.settings.formContainer+" input, ."+e.settings.formContainer+" select").blur(),!0===this.settings.querystringParams&&(this.getQueryString(this.settings.addressID)||this.getQueryString(this.settings.searchID)||this.getQueryString(this.settings.maxDistanceID))?(K=this.getQueryString(this.settings.addressID),U=this.getQueryString(this.settings.searchID),(s=this.getQueryString(this.settings.maxDistanceID))&&E("#"+this.settings.maxDistanceID+" option[value="+s+"]").length&&o.val(s),K&&s&&(e.settings.mapSettings.zoom=0),""!==n.val()&&(K=n.val()),""!==a.val()&&(U=a.val()),""!==o.val()&&(s=o.val())):(K=n.val()||"",U=a.val()||"",!0===this.settings.maxDistance&&(s=o.val()||"")),r=this.settings.callbackRegion?this.settings.callbackRegion.call(this,K,U,s):E("#"+this.settings.regionID).val(),this.settings.callbackFormVals&&this.settings.callbackFormVals.call(this,K,U,s,r),void 0!==r&&(i={country:r}),"function"==typeof this.settings.callbackGeocodeRestrictions&&(i=this.settings.callbackGeocodeRestrictions.call(this,K,U,s)),""===K&&""===U&&!0!==this.settings.autoGeocode?this._start():""!==K?(""===U&&et.hasOwnProperty("name")&&delete et.name,void 0!==z&&void 0!==l&&void 0!==g&&K===z?(st.lat=l,st.lng=g,st.origin=K,st.name=U,st.distance=s,e.mapping(st)):new this.googleGeocode(this).geocode({address:K,componentRestrictions:i,region:r},function(t){null!==t?(l=t.latitude,g=t.longitude,st.lat=l,st.lng=g,st.origin=K,st.name=U,st.distance=s,st.geocodeResult=t.geocodeResult,e.mapping(st)):e.notify(e.settings.addressErrorAlert)})):""!==U?(""===K&&delete st.origin,st.name=U,e.mapping(st)):!0===this.settings.autoGeocode&&(st.lat=l,st.lng=g,st.origin=K,st.name=U,st.distance=s,e.mapping(st))},locationsSetup:function(t,e,s,i,n){this.writeDebug("locationsSetup",arguments),void 0===i||t.distance||(t.distance=this.geoCodeCalcCalcDistance(e,s,t.lat,t.lng,u.EarthRadius),"m"===this.settings.lengthUnit?t.altdistance=1.609344*parseFloat(t.distance):"km"===this.settings.lengthUnit&&(t.altdistance=parseFloat(t.distance)/1.609344)),this.coordinatesInRange(t.lat,t.lng)?!0===this.settings.maxDistance&&null!=n?t.distance<=n?X.push(t):this.writeDebug("locationsSetup","location ignored because it is out of maxDistance: "+n,t):!0!==this.settings.maxDistance||!0!==this.settings.querystringParams||null==n||t.distance<=n?X.push(t):this.writeDebug("locationsSetup","location ignored because it is out of maxDistance: "+n,t):this.writeDebug("locationsSetup","location ignored because coordinates out of range: "+n,t)},sorting:function(){this.writeDebug("sorting",arguments);var s=this,i=E("#"+s.settings.mapID),t=E("#"+s.settings.sortID);0!==t.length&&t.on("change."+it,function(t){var e;t.stopPropagation(),!0===s.settings.pagination&&s.paginationChange(0),t=void 0!==E(this).find(":selected").attr("data-method")?E(this).find(":selected").attr("data-method"):"distance",e=E(this).val(),s.settings.sortBy.method=t,s.settings.sortBy.prop=e,s.settings.callbackSorting&&s.settings.callbackSorting.call(this,s.settings.sortBy),i.hasClass("bh-sl-map-open")&&s.mapping(st)})},order:function(){this.writeDebug("order",arguments);var e=this,s=E("#"+e.settings.mapID),t=E("#"+e.settings.orderID);0!==t.length&&t.on("change."+it,function(t){t.stopPropagation(),!0===e.settings.pagination&&e.paginationChange(0),e.settings.sortBy.order=E(this).val(),e.settings.callbackOrder&&e.settings.callbackOrder.call(this,e.settings.order),s.hasClass("bh-sl-map-open")&&e.mapping(st)})},distanceFiltering:function(){this.writeDebug("distanceFiltering");var e=this;E("#"+this.settings.maxDistanceID).on("change."+it,function(t){t.stopPropagation(),!0===e.settings.querystringParams&&(t=N.location.href,(t=new URL(t)).searchParams.set(e.settings.maxDistanceID,this.value),history.pushState?N.history.pushState({path:t.href},"",t.href):N.location.replace(t.href)),!0===E("#"+e.settings.mapID).hasClass("bh-sl-map-open")&&(l&&g?(e.settings.mapSettings.zoom=0,e.processForm()):e.mapping(st))})},countFilters:function(){this.writeDebug("countFilters");var t=0;if(!this.isEmptyObject(et))for(var e in et)et.hasOwnProperty(e)&&(t+=et[e].length);return t},_existingCheckedFilters:function(e){this.writeDebug("_existingCheckedFilters",arguments),E("#"+this.settings.taxonomyFilters[e]+" input[type=checkbox]").each(function(){var t;E(this).prop("checked")&&void 0!==(t=E(this).val())&&""!==t&&-1===et[e].indexOf(t)&&et[e].push(t)})},_existingSelectedFilters:function(e){this.writeDebug("_existingSelectedFilters",arguments),E("#"+this.settings.taxonomyFilters[e]+" select").each(function(){var t=E(this).val();void 0!==t&&""!==t&&-1===et[e].indexOf(t)&&(et[e]=[t])})},_existingRadioFilters:function(e){this.writeDebug("_existingRadioFilters",arguments),E("#"+this.settings.taxonomyFilters[e]+" input[type=radio]").each(function(){var t;E(this).prop("checked")&&void 0!==(t=E(this).val())&&""!==t&&-1===et[e].indexOf(t)&&(et[e]=[t])})},checkFilters:function(){for(var t in this.writeDebug("checkFilters"),this.settings.taxonomyFilters)this.settings.taxonomyFilters.hasOwnProperty(t)&&(this._existingCheckedFilters(t),this._existingSelectedFilters(t),this._existingRadioFilters(t))},selectQueryStringFilters:function(t,e){this.writeDebug("selectQueryStringFilters",arguments);var s=E("#"+this.settings.taxonomyFilters[t]);if(s.find('input[type="checkbox"]').length)for(var i=0;i<e.length;i++)s.find('input:checkbox[value="'+e[i]+'"]').prop("checked",!0);s.find("select").length&&s.find('option[value="'+e[0]+'"]').prop("selected",!0),s.find('input[type="radio"]').length&&s.find('input:radio[value="'+e[0]+'"]').prop("checked",!0)},checkQueryStringFilters:function(){for(var t in this.writeDebug("checkQueryStringFilters",arguments),et){var e;et.hasOwnProperty(t)&&(void 0!==(e=-1!==(e=this.getQueryString(t)).indexOf(",")?e.split(","):e)&&""!==e&&-1===et[t].indexOf(e)&&(Array.isArray(e)?et[t]=e:et[t]=[e]),et[t].length)&&this.selectQueryStringFilters(t,et[t])}},getFilterKey:function(t){for(var e in this.writeDebug("getFilterKey",arguments),this.settings.taxonomyFilters)if(this.settings.taxonomyFilters.hasOwnProperty(e))for(var s=0;s<this.settings.taxonomyFilters[e].length;s++)if(this.settings.taxonomyFilters[e]===t)return e},taxonomyFiltersInit:function(){for(var t in this.writeDebug("taxonomyFiltersInit"),this.settings.taxonomyFilters)this.settings.taxonomyFilters.hasOwnProperty(t)&&(et[t]=[])},taxonomyFiltering:function(){this.writeDebug("taxonomyFiltering");var n=this;n.taxonomyFiltersInit(),n.checkQueryStringFilters(),E("."+this.settings.taxonomyFiltersContainer).on("change."+it,"input, select",function(t){var e,s,i;t.stopPropagation(),!0===n.settings.pagination&&n.paginationChange(0),E(this).is('input[type="checkbox"]')?(n.checkFilters(),e=E(this).val(),s=E(this).closest(".bh-sl-filters").attr("id"),(i=n.getFilterKey(s))&&(E(this).prop("checked")?(-1===et[i].indexOf(e)&&et[i].push(e),!0===E("#"+n.settings.mapID).hasClass("bh-sl-map-open")&&(l&&g?(n.settings.mapSettings.zoom=0,n.processForm()):n.mapping(st))):-1<(t=et[i].indexOf(e))&&(et[i].splice(t,1),!0===E("#"+n.settings.mapID).hasClass("bh-sl-map-open"))&&(l&&g?(0===n.countFilters()?n.settings.mapSettings.zoom=V:n.settings.mapSettings.zoom=0,n.processForm()):n.mapping(st)))):(E(this).is("select")||E(this).is('input[type="radio"]'))&&(n.checkFilters(),e=E(this).val(),s=E(this).closest(".bh-sl-filters").attr("id"),i=n.getFilterKey(s),e?i&&(et[i]=[e],!0===E("#"+n.settings.mapID).hasClass("bh-sl-map-open"))&&(l&&g?(n.settings.mapSettings.zoom=0,n.processForm()):n.mapping(st)):(i&&(et[i]=[]),n.reset(),l&&g?(n.settings.mapSettings.zoom=V,n.processForm()):n.mapping(st)))})},checkVisibleMarkers:function(t,s){this.writeDebug("checkVisibleMarkers",arguments);var i,n=this;E("."+this.settings.locationList+" ul").empty(),E(t).each(function(t,e){s.getBounds().contains(e.getPosition())&&(n.listSetup(e,0,0),i=a(void 0),E("."+n.settings.locationList+" > ul").append(i))}),E("."+this.settings.locationList+" ul li:even").css("background",this.settings.listColor1),E("."+this.settings.locationList+" ul li:odd").css("background",this.settings.listColor2)},dragSearch:function(t){this.writeDebug("dragSearch",arguments);var e=t.getCenter(),s=this,t=(this.settings.mapSettings.zoom=t.getZoom(),l=st.lat=e.lat(),g=st.lng=e.lng(),new this.reverseGoogleGeocode(this)),e=new google.maps.LatLng(st.lat,st.lng);t.geocode({latLng:e},function(t){null!==t?(st.origin=K=t.address,s.mapping(st)):s.notify(s.settings.addressErrorAlert)})},emptyResult:function(){this.writeDebug("emptyResult",arguments);var t=E("."+this.settings.locationList+" ul"),e=this.settings.mapSettings;this.map=new google.maps.Map(j.getElementById(this.settings.mapID),e),this.settings.callbackNoResults&&this.settings.callbackNoResults.call(this,this.map,e),t.empty(),e=E('<li><div class="bh-sl-noresults-title">'+this.settings.noResultsTitle+'</div><br><div class="bh-sl-noresults-desc">'+this.settings.noResultsDesc+"</li>").hide().fadeIn(),t.append(e),t=l&&g?new google.maps.LatLng(l,g):new google.maps.LatLng(0,0),this.map.setCenter(t),V&&this.map.setZoom(V)},originMarker:function(t,e,s){var i;this.writeDebug("originMarker",arguments),!0===this.settings.originMarker&&(i="",void 0!==e)&&(i=null!==this.settings.originMarkerImg?null===this.settings.originMarkerDim?this.markerImage(this.settings.originMarkerImg):this.markerImage(this.settings.originMarkerImg,this.settings.originMarkerDim.width,this.settings.originMarkerDim.height):{url:"https://mt.googleapis.com/vt/icon/name=icons/spotlight/spotlight-waypoint-a.png"},new google.maps.Marker({position:s,map:t,icon:i,draggable:!1}))},modalWindow:function(){var e;this.writeDebug("modalWindow"),!0===this.settings.modal&&((e=this).settings.callbackModalOpen&&e.settings.callbackModalOpen.call(this),E("."+e.settings.overlay).fadeIn(),E(j).on("click."+it,"."+e.settings.closeIcon+", ."+e.settings.overlay,function(){e.modalClose()}),E(j).on("click."+it,"."+e.settings.modalWindow,function(t){t.stopPropagation()}),E(j).on("keyup."+it,function(t){27===t.keyCode&&e.modalClose()}))},openNearestLocation:function(t,e,s,i){var n,a;this.writeDebug("openNearestLocation",arguments),!0!==this.settings.openNearest||void 0===t||void 0===z||!0===this.settings.fullMapStart&&!0===W&&!1===this.settings.querystringParams||!0===this.settings.defaultLoc&&!0===W&&!1===this.settings.querystringParams||((n=this).settings.callbackNearestLoc&&n.settings.callbackNearestLoc.call(this,n.map,t,e,s,i),t=t.hasOwnProperty("markerid")?t.markerid:0,a=tt[t],n.createInfowindow(a,"left",e,s,i),a=E("."+n.settings.locationList),e=E("."+n.settings.locationList+" li[data-markerid="+t+"]"),E("."+n.settings.locationList+" li").removeClass("list-focus"),e.addClass("list-focus"),a.animate({scrollTop:e.offset().top-a.offset().top+a.scrollTop()}))},listClick:function(s,i,n,a){this.writeDebug("listClick",arguments);var o=this;E(j).on("click."+it,"."+o.settings.locationList+" li",function(){var t=E(this).data("markerid"),e=tt[t];o.settings.callbackListClick&&o.settings.callbackListClick.call(this,t,e,X[t],s),s.panTo(e.getPosition());o.createInfowindow(e,"left",i,n,a),null!==o.settings.selectedMarkerImg&&o.changeSelectedMarker(e),E("."+o.settings.locationList+" li").removeClass("list-focus"),E("."+o.settings.locationList+" li[data-markerid="+t+"]").addClass("list-focus")}),E(j).on("click."+it,"."+o.settings.locationList+" li a",function(t){t.stopPropagation()})},resultsTotalCount:function(t){this.writeDebug("resultsTotalCount",arguments);var e=E(".bh-sl-total-results");void 0===t||t<=0||0===e.length||e.text(t)},inlineDirections:function(e,s){var i;this.writeDebug("inlineDirections",arguments),!0===this.settings.inlineDirections&&void 0!==s&&(i=this,E(j).on("click."+it,"."+i.settings.locationList+" li .loc-directions a",function(t){t.preventDefault();t=E(this).closest("li").attr("data-markerid");i.directionsRequest(s,parseInt(t),e),E(j).on("click."+it,"."+i.settings.locationList+" .bh-sl-close-icon",function(){i.closeDirections()})}))},visibleMarkersList:function(t,e){var s;this.writeDebug("visibleMarkersList",arguments),!0===this.settings.visibleMarkersList&&(s=this,google.maps.event.addListenerOnce(t,"idle",function(){s.checkVisibleMarkers(e,t)}),google.maps.event.addListener(t,"center_changed",function(){s.checkVisibleMarkers(e,t)}),google.maps.event.addListener(t,"zoom_changed",function(){s.checkVisibleMarkers(e,t)}))},featuredDistanceRestriction:function(){this.writeDebug("featuredDistanceRestriction",arguments);var e=this;return Z=E.grep(Z,function(t){if(t.hasOwnProperty("distance"))return parseFloat(t.distance)<=parseFloat(e.settings.featuredDistance)})},featuredRestrictions:function(t){return this.writeDebug("featuredRestrictions",arguments),Z=null!==this.settings.featuredDistance&&null!==this.settings.featuredDistance?this.featuredDistanceRestriction(t):Z},mapping:function(e){this.writeDebug("mapping",arguments);var t,s,i,n,a,o,r=this;this.isEmptyObject(e)||(t=e.lat,s=e.lng,i=e.geocodeResult,n=e.origin,o=e.page),!0!==r.settings.pagination||void 0!==o&&z===K||(o=0),q=void 0===n&&!0===this.settings.nameSearch?r._getData():(a=new google.maps.LatLng(t,s),void 0!==z&&n===z&&void 0!==Q?(n=z,Q):r._getData(l,g,n,i,e)),null!==r.settings.taxonomyFilters&&r.hasEmptyObjectVals(et)&&r.checkFilters(),null!==r.settings.dataRaw?r.processData(e,a,q,o):q.done(function(t){r.processData(e,a,t,o)})},resetDisabledFilterVals:function(){for(var t in this.writeDebug("resetDisabledFilterVals"),this.settings.taxonomyFilters)if(this.settings.taxonomyFilters.hasOwnProperty(t))for(var e=0;e<this.settings.taxonomyFilters[t].length;e++)E("#"+this.settings.taxonomyFilters[t]+" input,option").each(function(){void 0!==E(this).attr("disabled")&&E(this).removeAttr("disabled")})},getAvailableFilters:function(t){this.writeDebug("getAvailableFilters");var e,s,i,n=[];for(e in X)if(X.hasOwnProperty(e))for(var a in X[e])et.hasOwnProperty(a)&&""!==X[e][a]&&(n.hasOwnProperty(a)?(s=n[a].concat(",",X[e][a].replace(", ",",").trim()),n[a]=Array.from(new Set(s.split(","))).toString()):n[a]=X[e][a].replace(", ",",").trim());for(i in et)n.hasOwnProperty(i)||(n[i]="");t(n)},maybeDisableFilterOptions:function(){this.writeDebug("maybeDisableFilterOptions");var i=[],n=this;this.resetDisabledFilterVals(),this.getAvailableFilters(function(t){for(var e in i=t,void 0===o&&(o=i),n.settings.taxonomyFilters)if(n.settings.taxonomyFilters.hasOwnProperty(e))for(var s=0;s<n.settings.taxonomyFilters[e].length;s++)n.settings.taxonomyFilters.hasOwnProperty(e)&&E("#"+n.settings.taxonomyFilters[e]+" input, #"+n.settings.taxonomyFilters[e]+" option").each(function(){""===E(this).val()||Array.from(new Set(i[e].split(","))).includes(E(this).val())||(d.hasOwnProperty(e)||(d[e]=[]),!(void 0!==K&&""!==K||"OPTION"!==E(this).prop("tagName")&&"radio"!==E(this).prop("type"))&&n.hasSingleGroupFilterVal(et,e)&&Array.from(new Set(o[e].split(","))).includes(E(this).val()))||!(void 0===K&&""===K||"OPTION"!==E(this).prop("tagName")&&"radio"!==E(this).prop("type"))&&n.hasSingleGroupFilterVal(et,e)&&Array.from(new Set(o[e].split(","))).includes(E(this).val())&&1===n.countFilters()||("OPTION"===E(this).prop("tagName")||"radio"===E(this).prop("type"))&&n.hasSingleGroupFilterVal(et,e)&&1<n.countFilters()&&Array.from(new Set(o[e].split(","))).includes(E(this).val())&&!d[e].includes(E(this).val())||(d.hasOwnProperty(e)&&Array.isArray(d[e])&&!d[e].includes(E(this).val())&&d[e].push(E(this).val()),E(this).attr("disabled",!0))})})},processData:function(t,e,s,i){this.writeDebug("processData",arguments);var n,a,o,r,l,g,c,h,u,d,p,m=this,f=0,b={},y=E("#"+m.settings.lengthSwapID),v=(this.isEmptyObject(t)||(n=t.lat,a=t.lng,o=t.origin,t.name,r=t.distance),E("#"+m.settings.mapID)),w="km"===m.settings.lengthUnit?m.settings.kilometersLang:m.settings.milesLang;if(Q=q,void 0!==o&&(z=o),m.settings.callbackSuccess&&m.settings.callbackSuccess.call(this,t,e,s,i),P=v.hasClass("bh-sl-map-open"),!0===m.settings.fullMapStart&&!1===P||!0===m.settings.autoGeocode&&!1===P||!0===m.settings.defaultLoc&&!1===P?W=!0:(!0===m.settings.fullMapStart&&!0===J||!0===m.settings.autoGeocode&&!0===J||m.settings.defaultLoc,m.reset()),v.addClass("bh-sl-map-open"),"json"===m.settings.dataType||"jsonp"===m.settings.dataType)for(var D=0;f<s.length;D++){var k,L=s[D],S={};for(k in L)L.hasOwnProperty(k)&&(S[k]=L[k]);m.locationsSetup(S,n,a,o,r),f++}else"kml"===m.settings.dataType?E(s).find("Placemark").each(function(){var t={name:E(this).find("name").text(),lat:E(this).find("coordinates").text().split(",")[1],lng:E(this).find("coordinates").text().split(",")[0],description:E(this).find("description").text()};m.locationsSetup(t,n,a,o,r),f++}):E(s).find(m.settings.xmlElement).each(function(){var t,e={};for(t in this.attributes)this.attributes.hasOwnProperty(t)&&(e[this.attributes[t].name]=this.attributes[t].value);m.locationsSetup(e,n,a,o,r),f++});if(!0===m.settings.nameSearch){if(void 0!==U&&""!==U)if(m.settings.nameAttribute.indexOf(",")){$=m.settings.nameAttribute.split(","),null!==m.settings.exclusiveTax?m.settings.exclusiveTax.concat($):m.settings.exclusiveTax=$;for(var M=0;M<$.length;M++)et[$[M].trim()]=[U]}else et[m.settings.nameAttribute]=[U];if(void 0!==U&&""===U)if(void 0!==$)for(var C=0;C<$.length;C++)$[C]in et&&delete et[$[C]];else delete et[m.settings.nameAttribute]}if(null!==m.settings.taxonomyFilters||!0===m.settings.nameSearch){for(var I in et)if(et.hasOwnProperty(I)&&0<et[I].length)for(var x=0;x<et[I].length;x++)b[I]||(b[I]=[]),void 0!==$?-1!==$.indexOf(I)?b[I][x]="(?:^|\\s)"+et[I][x].replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,""):b[I][x]="(?=.*"+et[I][x].replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,"")+"(?!\\s))":I===m.settings.nameAttribute?b[I][x]="(?:^|\\s)"+et[I][x].replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,""):b[I][x]="(?=.*"+et[I][x].replace(/([.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,"")+"(?!\\s))";m.isEmptyObject(b)||(X=E.grep(X,function(t){return m.filterData(t,b)}))}if(null!==m.settings.sortBy&&"object"==typeof m.settings.sortBy)!0===m.settings.openNearest&&void 0!==z&&(this.sortNumerically(X,!0),void 0!==X[0])&&(d=this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?X[X.length-1]:X[0]),m.sortCustom(X);else{if(void 0!==o&&m.sortNumerically(X),m.isEmptyObject(b))if(!0===m.settings.maxDistance&&r)(void 0===X[0]||X[0].distance>r)&&m.notify(m.settings.distanceErrorAlert+r+" "+w);else{if(void 0===X[0])throw m.emptyResult(),new Error("No locations found. Please check the dataLocation setting and path.");-1!==m.settings.distanceAlert&&X[0].distance>m.settings.distanceAlert&&(m.notify(m.settings.distanceErrorAlert+m.settings.distanceAlert+" "+w),h=!0)}void 0!==X[0]&&(d=X[0])}if(!0===m.settings.featuredLocations&&(Z=E.grep(X,function(t){if(t.hasOwnProperty("featured"))return"true"===t.featured}),Z=m.featuredRestrictions(t),Y=E.grep(X,function(t){if(t.hasOwnProperty("featured"))return"true"!==t.featured}),X=[],X=Z.concat(Y)),(!0!==W&&!1===m.settings.exclusiveFiltering||!0===m.settings.fullMapStart&&!1===m.settings.exclusiveFiltering||!0===m.settings.defaultLoc&&!1===m.settings.exclusiveFiltering)&&m.maybeDisableFilterOptions(),!0===m.settings.slideMap&&_.slideDown(),!0===m.settings.pagination&&m.paginationSetup(i),!0===m.settings.altDistanceNoResult&&d.distance>m.settings.distanceAlert)m.emptyResult();else if(m.isEmptyObject(X)||"none"===X[0].result)m.emptyResult();else{m.modalWindow(),H=-1===m.settings.storeLimit||X.length<m.settings.storeLimit||!0===this.settings.fullMapStart&&!0===W&&(!isNaN(this.settings.fullMapStartListLimit)||26<this.settings.fullMapStartListLimit||-1===this.settings.fullMapStartListLimit)?X.length:m.settings.storeLimit,!0!==m.settings.fullMapStart||!m.isEmptyObject(b)||""!==U&&void 0!==U||""!==K&&void 0!==K||(H=X.length),!0===m.settings.pagination?(c=m.settings.locationsPerPage,(g=i*m.settings.locationsPerPage)+c>X.length&&(c=m.settings.locationsPerPage-(g+c-X.length)),X=X.slice(g,g+c),H=X.length):(c=H,g=0),m.resultsTotalCount(X.length),!0===m.settings.fullMapStart&&!0===W&&!0!==m.settings.querystringParams||0===m.settings.mapSettings.zoom||void 0===o||!0===h||!0===m.settings.maxDistance&&!1===W&&0<this.countFilters()?(p=m.settings.mapSettings,l=new google.maps.LatLngBounds):p=(!0===m.settings.pagination?(P=new google.maps.LatLng(X[0].lat,X[0].lng),m.settings.mapSettings.center=0===i?e:P):m.settings.mapSettings.center=e,m.settings.mapSettings),m.map=new google.maps.Map(j.getElementById(m.settings.mapID),p),N.addEventListener("resize",function(){var t=m.map.getCenter();google.maps.event.trigger(m.map,"resize"),m.map.setCenter(t)}),!0===m.settings.dragSearch&&m.map.addListener("dragend",function(){m.dragSearch(m.map)}),_.data(m.settings.mapID.replace("#",""),m.map),m.settings.callbackMapSet&&m.settings.callbackMapSet.call(this,m.map,e,V,p),u="undefined"!=typeof InfoBubble&&null!==m.settings.infoBubble?((v=m.settings.infoBubble).map=m.map,new InfoBubble(v)):new google.maps.InfoWindow,m.originMarker(m.map,o,e),E(j).on("click."+it,".bh-sl-pagination li",function(t){t.preventDefault(),m.paginationChange(E(this).attr("data-page"))}),m.inlineDirections(m.map,o);for(var F,P,O=0;O<=c-1;O++){var R="",R=0<i?String.fromCharCode("A".charCodeAt(0)+(g+O)):String.fromCharCode("A".charCodeAt(0)+O),A=new google.maps.LatLng(X[O].lat,X[O].lng);if((R=m.createMarker(A,X[O].name,X[O].address,R,m.map,X[O].category)).set("id",O),tt[O]=R,X[O].markerid=R.get("id"),null!==this.settings.dataRaw)for(var G=0;G<this.settings.dataRaw.length;G++)this.settings.dataRaw[G]&&this.settings.dataRaw[G].hasOwnProperty("id")&&this.settings.dataRaw[G].id===X[O].id&&(this.settings.dataRaw[G].markerid=X[O].markerid);(!0===m.settings.fullMapStart&&!0===W&&!0!==m.settings.querystringParams||0===m.settings.mapSettings.zoom||void 0===o||!0===h||!0===m.settings.maxDistance&&!1===W&&0<this.countFilters())&&l.extend(A),m.createInfowindow(R,null,u,g,i)}if((!0===m.settings.fullMapStart&&!0===W&&!0!==m.settings.querystringParams||0===m.settings.mapSettings.zoom||void 0===o||!0===h||!0===m.settings.maxDistance&&!1===W&&0<this.countFilters())&&(m.map.fitBounds(l),F=google.maps.event.addListener(m.map,"idle",function(){16<m.map.getZoom()&&m.map.setZoom(16),google.maps.event.removeListener(F)})),E("."+m.settings.locationList+" ul").empty(),W&&!1!==m.settings.fullMapStartListLimit&&!isNaN(m.settings.fullMapStartListLimit)&&-1!==m.settings.fullMapStartListLimit&&tt.length>m.settings.fullMapStartListLimit)for(var T=0;T<m.settings.fullMapStartListLimit;T++){var B=tt[T];m.listSetup(B,g,i)}else E(tt).each(function(t){t=tt[t];m.listSetup(t,g,i)});y.length&&(m.lengthUnitSwap(y),y.on("change."+it,function(t){t.stopPropagation(),m.lengthUnitSwap(y)})),m.openNearestLocation(d,u,g,i),"undefined"!=typeof MarkerClusterer&&null!==m.settings.markerCluster&&new MarkerClusterer(m.map,tt,m.settings.markerCluster),m.listClick(m.map,u,g,i),E("."+m.settings.locationList+" ul > li:even").css("background",m.settings.listColor1),E("."+m.settings.locationList+" ul > li:odd").css("background",m.settings.listColor2),m.visibleMarkersList(m.map,tt),!0===m.settings.querystringParams&&(w=E("#"+m.settings.addressID),P=E("#"+m.settings.searchID),void 0!==st&&st.hasOwnProperty("origin")&&""===w.val()&&w.val(st.origin),void 0!==st)&&st.hasOwnProperty("name")&&""===P.val()&&P.val(st.name),!0===m.settings.modal&&m.settings.callbackModalReady&&m.settings.callbackModalReady.call(this,t),m.settings.callbackFilters&&m.settings.callbackFilters.call(this,et,t)}},writeDebug:function(){N.console&&this.settings.debug&&(Function.prototype.bind?this.writeDebug=Function.prototype.bind.call(console.log,console,"StoreLocator :"):this.writeDebug=function(){arguments[0]="StoreLocator : "+arguments[0],Function.prototype.apply.call(console.log,console,arguments)},this.writeDebug.apply(this,arguments))}}),E.fn[it]=function(e){var s,i=arguments;return e===t||"object"==typeof e?this.each(function(){E.data(this,"plugin_"+it)||E.data(this,"plugin_"+it,new m(this,e))}):"string"==typeof e&&"_"!==e[0]&&"init"!==e?(this.each(function(){var t=E.data(this,"plugin_"+it);t instanceof m&&"function"==typeof t[e]&&(s=t[e].apply(t,Array.prototype.slice.call(i,1))),"destroy"===e&&E.data(this,"plugin_"+it,null)}),s!==t?s:this):void 0})}(jQuery,window,document);